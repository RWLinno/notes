





# 复习重点

### 第一章 操作系统引论

#### 1 .1 操作系统的目标和作用

##### 目标

- 方便性、有效性、可扩充性、开放性

##### 使用OS的方式

- 命令方式、图像窗口方式、系统调用方式

##### 资源的种类

- 处理器/存储器/IO设备/信息(数据和程序)

#### 1.2 操作系统的发展过程

1.无操作系统的计算机系统

   - 人工操作方式
   - 脱机输入/输出（Off-Line I/O）

2.单道“批处理”系统

3.多道“批处理”系统

    - 多道性、无序性、调度性、无交互能力

4.分时系统

- 人机交互/共享主机
- 多路性、独立性、及时性、交互性

5.实时系统

- 比分时系统多一个可靠性 

#### 1.3 操作系统基本特性

- 并发

并发是计算机操作系统的一大重要特性，正是由于并发的存在，才能使操作系统提高系统中的资源利用率和吞吐量。

并行是两个或多个事件在**同一时刻**发生，而并发是两个或多个事件**在同一时间间隔内**发生。

- 共享

系统中的资源可供内存中多个并发执行的进程（线程）共同使用。

主要有两种资源共享方式：**互斥性访问/“同时”访问**

- 虚拟

指通过某种技术把一个物理实体变为若干个逻辑上的实物。

- 异步 

进程是**以不可预知的速度**在向前推进，这就是进程的异步性。

#### 1.4 操作系统的主要功能

处理机管理功能：

- 进程控制、进程同步、进程通信、调度

存储器管理功能：

- 内存分配、内存保护、地址映射、内存扩充

设备管理：

- 缓冲管理、设备分配、设备处理

文件管理：

- 文件存储空间的管理、目录管理文件的读/写管理和保护

用户接口：

- 命令接口、程序接口、图形接口

##### 操作系统结构

无结构操作系统

模块化OS系统

分层式OS结构

微内核OS结构



### 第二章 进程的描述和控制

##### 进程挂起的原因

（1）终端用户的需要

（2）父进程请求

（3）负荷调节的需要

（4）操作系统的需要

##### 描述PCB的作用

为了便于系统描述和管理进程的运行，在OS的核心为每个进程专门定义了一个数据结构——进程控制块PCB(Process Control Block)。PCB作为进程实体的一部分，记录了操作系统所需的，用于描述仅的当前情况以及管理进程运行的全部信息，是操作系统中最重要的记录型数据结构。

##### PCB中的信息

（1）进程标识符

（2）处理机状态

（3）进程调度信息

（4）进程控制信息

##### PCB的组织方式

- 线性方式、链接方式、索引方式

##### 操作系统内核功能

（1）支撑功能：中断处理、始终管理、原语操作

（2）资源管理功能：进程管理、存储器管理、设备管理

##### 临界区和临界资源

临界资源：一次仅允许一个进程使用的共享资源。

临界区：每个进程中访问临界资源的 *那段代码* 称为临界区。

##### 同步机制应遵循的规则

- 空闲让进：当无进程处于临界区时，表明临界资源处于空闲状态，允许一个请求进入临界区的进程立刻进入临界区，以有效利用临界资源。
- 忙则等待：当已有进程处于临界区时，表明临界资源正在被访问，因而其他试图进入临界区的进程必须等待，以保证对临界资源的互斥访问。
- 有限等待：对要求访问临界资源的进程，应保证在有限时间内能进入自己的临界区，以免陷入“死等”状态。
- 让权等待：当进程不能进入自己的临界区时，应立即释放处理机，以免进程陷入“忙等”状态。

##### 信号量机制

P/wait操作：分配一个资源，令资源数减一。

V/signal操作：释放一个资源，令资源数加一。 

##### 经典进程同步问题

- 生产者-消费者问题、哲学家进餐问题、读者-写者问题（了解）

##### 进程通信的类型

（1）共享存储器系统

（2）管道通信系统

（3）消息传递系统

（4）客户机-服务器系统

##### 进程间同步和互斥的含义

同步：并发程序之间存在的相互制约和相互依赖关系。

互斥：若干进程共享同一资源时，任何时刻只允许一个进程使用。

#### 线程

什么是线程？为什么用线程？线程和进程的不同点？

##### 进程与线程比较

|          | 进程                                     | 线程                                                         |
| -------- | ---------------------------------------- | ------------------------------------------------------------ |
| 引入目的 | 能并发执行，提高资源的利用率和系统吞吐率 | 提高并发执行的程度，减少开销，进一步提高资源的利用率和系统吞吐率。 |
| 并发性   | 较少                                     | 较高                                                         |
| 基本属性 | 资源拥有的基本单位                       | 独立调度/分派的基本单位                                      |
| 基本状态 | 就绪；执行；等待                         | 就绪；执行；等待                                             |
| 拥有资源 | 资源拥有的基本单位                       | 无资源分配                                                   |
| 系统开销 | 创建/撤销/切换时空开销大                 | 创建/撤销/切换时空开销较小                                   |
| 系统操作 | 创建；撤销；切换                         | 创建；撤销；切换                                             |
| 存在标志 | 进程控制块（PCB）                        | 线程控制块（TCB）                                            |

**进程与线程的关系：n对n。**



#### 例题

在一个多道程序系统中，进程之间存在着不同关系可以划分为两大类：其中**（同步）**指进程间存在一定的逻辑关系，需要在执行次序上协调；**（互斥）**指进程间在使用共享资源方面的约束关系。解决上述两个问题的一种常用的方法是**（信号量机制）**

在多用户系统中应为**每个用户（进程）**设置一张**逻辑设备表**。

##### 作业与进程的主要区别

- 前者是由用户提交，后者是由系统自动生成
- 前者以用户任务为单位，后者是操作系统控制的单位。

##### 程序状态字包括哪些主要内容？

- 程序基本状态、中断码、中断屏蔽位

引入**进程**的目的：为了更好地描述和控制程序，**实现操作系统的并发性和共享性**。

引入**线程**的目的：为了更好地使用多道程序并发执行，**提高资源利用率和系统吞吐量**。

**程序和进程的区别**：①进程是动态的，程序是静态的。程序是有序代码的集合，进程是程序的执行；②进程是暂时的，程序是永久的。进程是一个状态变化的过程，程序可长久保存；③进程与程序的组成不同，进程的组成包括程序、数据和进程控制块（即进程状态信息）；④通过多次执行，一个程序可以对于多个进程；通过调用关系，一个进程可包含多个程序。



### 第三章

#### 3.1 处理机调度的层次和调度算法的目标

##### 处理机调度

对处理机进行分配，即从就绪队列中按照给定的算法（公平、高效）选择一个进程并将处理机分配给它运行，以实现进程并发地执行。

层次：高级调度（作业调度），中级调度（内存兑换），低级调度（进程调度）。

调度方式：剥夺式（抢占式）和非剥夺式（非抢占式）。

#### 3.2 作业与作业调度

##### 作业运行的三个阶段和三种状态

收容、运行、完成。

##### 调度算法

- 先来先服务（FCFS）

- 短作业优先调度（SJF/SPF）

- 高优先权优先调度(FPF)

- 基于时间片的轮转调度(RR)

#### 3.4 实时调度算法

- 最早截止时间优先（EDF）
  - 根据任务的截止时间来确定任务的优先级。

- 最低松弛度优先（LLF）

  - 主要用于可抢占的调度方式中。

  - 松弛度 = 必须完成时间 - 本身运行时间 - 当前时间

##### 优先级倒置

优先级倒置的原因是因为**低优先级进程阻塞或延迟了高优先级进程的执行**。



#### 3.5 死锁

##### 什么是死锁？产生死锁的原因和必要条件是什么？

（1）在多道程序系统中，当一组进程中的每个进程均无限期地等待被改组进程中的另一进程所占有且永远不会释放的资源，此时的系统处于死锁状态，简称死锁。

（2）死锁产生的原因：系统提供的资源有限 且 进程推进顺序不当

（3）产生死锁的必要条件：①互斥条件、②不可剥夺条件、③请求和保持条件、④循环等待条件

##### 死锁处理方法

①预防死锁；②避免死锁；③检查死锁；④解除死锁。

避免死锁的方法一般是以**降低资源利用率**为代价的。

若系统规定进程在申请资源时，不保持任何资源，则该系统**一定不会**出现死锁。

银行家算法是一种**死锁避免**的算法。

对资源编号，要求进程按照序号**顺序申请资源**，是破坏了死锁必要条件中的**循环等待**。

##### 银行家算法

需要用到的数据结构

- 可利用资源向量 Available
- 最大需求矩阵Max
- 分配矩阵Allocation
- 需求矩阵Need

安全性算法

##### 死锁定理

死锁检测：资源分配图

死锁定理：S为死锁的充分条件为：当且仅当S状态的资源分配图是不可完全简化的。该充分条件被称为死锁定理。

#### 例题

##### 说明作业调度，中级调度和进程调度的区别，且分析下述问题应该由哪一级调度程序负责。

（1）在可获得处理机时，应将它分给哪个就绪进程。**——进程调度**

（2）在短期繁重负载下，应将哪个进程暂时挂起。**——中级调度**

作业调度用于决定把后备队列中的哪些作业调入内存，并为它们创建进程，分配资源，然后将新创建进程插入就绪队列；中级调度负责将内存中暂时不具备运行条件的进程换到外存交换区存放，但内存空闲时，又将外存中具备运行条件的进程重新换入内存；进程调度决定将处理机分配给就绪进程队列的哪个进程。





### 第四章 存储器管理

#### 4.1 存储器的层次结构

##### 引入目的

更好地支持多道程序的并发执行，提高系统性能。

##### 主要功能

（1）内存空间的分配与回收

（2）存储的保护和共享：

（3）地址转换：把逻辑地址转化为相应的物理地址。

（4）内存扩充：利用虚拟存储技术或自动覆盖技术，从逻辑上扩充内存。

##### 内存分配策略

在请求分页系统中，可采用两种内存分配策略：**固定和可变分配策略**。

在置换时，也可采用两种置换策略：**全局置换和局部置换**。

##### 内存扩充

- 覆盖（同一程序或进程中）：将程序分为多个段（模块），常用的段常驻内存，不常用的段在需要时调入内存。

- 交换（不同进程/作业之间进行）：内存空间紧张时，系统将内存中某些进程暂时换出外存，把外存中某些已具备运行条件的进程换入内存。（进程在内存和磁盘之间动态调度）

#### 4.2 程序的装入和链接

##### 用户程序的主要处理阶段

（1）编辑阶段

（2）编译阶段

（3）链接阶段

（4）装入阶段

（5）运行阶段地址转化为相应的物理地址。

（4）内存扩充：利用虚拟存储技术或自动覆盖技术，从逻辑上扩充内存。

##### 用户程序的主要处理阶段

编辑、编译、链接、装入、运行

##### 程序装入

- 绝对装入

编译后，装入前已产生了绝对地址（内存地址），装入时不再作地址重定位。

- 可重定位装入
  - 静态重定位：装入时完成，主要工作哦是对相同地址中的指令和数据地址的调整过程。
  - 动态运行时装入：程序执行过程中，当访问指令或数据时，才进行的地址变换方式。

##### 程序链接

静态链接、装入时动态链接、运行时动态链接。

##### 链接组织方式

（1）消除了磁盘的外部碎片，提高了外存的利用率。

（2）对插入、删除和修改记录都非常容易。

（3）能适应文件的动态增长，无需实现知道文件的大小。

链接方式又可以分为隐式链接和显式链接。

#### 4.3 连续分配管理

**单一连续分配**：分配到内存固定的区域（单用户/单任务的操作系统）

**固定分区分配**：分配到内存不同的固定区域，分区可以相等可以不等，但要求一定是固定。

##### 动态分区分配（重点）

可变分区存储管理：按照程序的需要进行动态的划分。

（掌握、理解图4.8、4.9）

在**动态分区分配管理**中，首次适应分配算法要求对空闲区表项按**地址从小到大**进行排列。

##### 基于顺序搜索的动态分区分配算法

- 首次适应
- 循环首次适应
- 最佳适应
- 最坏适应

##### 基于索引搜索的动态分区分配算法

- 快速适应算法
- 伙伴系统（掌握）
- 哈希算法

#### 4.4对换

将阻塞的进程、暂时不用的程序、数据换出，将具备运行条件的数据换入。

类型：**整体对换、部分对换**（页面对换、分段对换）

空间管理： 分为**对换区和文件区**



#### 4.5 分页存储管理

**引入：**连续分配引起碎片

**页面和物理块：**由机器的地址结构决定，将一个进程的逻辑地址空间氛围若干个大小相等的片，成为页面或页，并为各页加以编号，从0开始。相应的把内存空间分成与页面相同大小的若干个存储块，称为物理块或页框。

地址变换结构：页表完成逻辑页号到物理块号的映射。

有快表访问内存速度会提高，但是快表不能太多。

#### 4.6 分段存储管理

 引入分段式存储管理方式的原因：（1）方便编程；（2）分段共享；（3）分段保护；（4）动态链接；（5）动态增长

##### 分段系统的基本原理

##### 分页与分段的主要区别

①页是信息的物理单位，已削减内存零头，提高内存利用率为目的，而不是用户的需求；段是信息的逻辑单位，具有相对完整的意义，是为了满足用户的需求。

②页的大小固定，由系统确定。段的大小不固定，决定于用户编写的程序。

③分页的作业地址是一维的，分段的作业地址是二维的。 



#### 例题

常用的存储保护技术有**①存储键、②界地址、③寄存器越界保护**。

用于分区存储管理的存储分配算法有：**①最佳适应法；②首次适应法；③最坏适应法。**

动态分区的分配算法中，**最坏适应算法**对大作业不公平。

导致碎片最严重的存储管理方式：**固定分区管理**。

在动态分区时内存管理中，能使内存空间中空闲区分布得较均匀的算法：**循环首次适应算法**。

##### 为实现分页式虚拟存贮，页表中至少应含有哪些内容？

页号、标志、主存块号、磁盘上的位置。



### 第五章 虚拟存储器

常规存储器特征：一次性、驻留性

一次性：作业被一次地全部装入内存，才会出现前述的两个问题。实际上，一段时间内只用到部分程序与数据，没必要全部装入。

驻留性：作业装入内存后，灰一直驻留在内存，直到结束，就算一段时间不允许，页不让出内存。

局部性：程序在执行时

局部性原理：时间局部性（循环执行）、空间局部性（顺序执行）

虚拟存储器：具有请求调入功能和置换功能，能从逻辑上与内存容量进行扩充难度一种存储系统。

实质：以时间换空间，但空间牺牲不大。

虚拟存储器特征：离散性（部分装入）、多次性（局部多次装入）、对换性、虚拟性

##### 为什么引入虚存

在逻辑上扩充内存。

##### 虚存特征

- 多次性、对换性、虚拟性

##### 实现方法

1.分页请求系统

- 硬件支持：（1）请求分页的页表机制；（2）缺页中断机构；（3）地址变换机构

2.请求分段系统

- 硬件支持：（1）请求分段的段表机制；（2）缺段中断机制；（3）地址变换机构

##### 整体流程

CPU需要取地址，首先访问页表（**页表包含页号和块号两部分**），如果在页表中找到了，那么利用地址变换机制，变成真正的物理地址，计算机通过寻找该物理地址找到自己需要的资源。	如果发现页表没有自己想要的页表项，那么会触发缺页中断（缺页中断就是要访问的页不在内存，需要操作系统将其调入主存后再进行访问。）从外存调入内存的过程，如果页表满了，需要从满了的页表项中进行替换。



#### 5.3 页面置换算法

- 最佳(Optimal)置换算法**(掌握)**：把以后不再使用的或长时间内不会用到的页面淘汰出去（理论上不会实现）

- 先进先出(FIFO)页面置换算法

- 淘汰最先进入内存的页面。

- 最近最久未使用(LRU)置换算法**(掌握)**：总是把最长时间未被访问过的页面淘汰出去（需要寄存器和栈）。

- 最少使用(LFU)置换算法：总是把当前使用的最少的页面淘汰出去。

- Clock算法(理解)



#### 例题





### 第六章 输入输出系统

#### 6.1 I/O系统的功能、模型和接口

I/O系统管理的主要对象：IO设备和相应的设备控制器。

最主要任务：完成用户提出的I/O请求。

##### 基本功能

①隐藏物理设备的细节

②与设备的无关性

③提高处理机和I/O设备的利用率

④对I/O设备进行控制

⑤确保对设备的正确共享

⑥错误处理

##### I/O系统的分层

（1）中断处理程序

（2）设备驱动程序

（3）设备独立性/无关性软件

（4）用户层I/O软件

#### 6.2 I/O设备和设备控制器

##### 设备管理的目标

方便使用、与设备无关、效率高、管理统一。

##### I/O设备分类

- 按某性质：块设备或字符设备、独占设备或共享设备
- 按使用特性：存储设备或输入输出设备
- 按速率：低速中速高速设备

#### 6.3  中断机构和中断处理程序（掌握重要性、图）

中断在操作系统中有着特殊重要的地位，它是多道程序得以实现的基础。

##### 中断和陷入

##### 中断向量表和中断优先级

##### 中断处理程序



#### 6.4 设备驱动程序

##### 设备处理方式

（1）为每一类设备设置一个进程，专门用于执行这类设备的I/O操作。

（2）在整个系统中设置一个I/O进程，专门用于执行系统中所有各类设备的I/O操作。

（3）不设置专门的设备处理程序，而只为各类设备设置相应的设备驱动程序，供用户或系统进程调用。	

##### 对I/O设备的控制方式(重点)

- 程序查询方式：cpu不断地去查询设备控制器是否将数据放到了数据存储器中，或者从数据存储器到设备中，当完成IO时CPU才能去干别的事。
- I/O中断方式：当CPU发出指令后就可以去干别的事，当设备控制器把数据存在数据存储器后向cpu发出中断请求，然后cpu再来处理这部分数据。
- DMA方式：这种方式由DMA控制器直接将设备中的数据以数据块为单位直接传输到内存中，当传输结束后才向cpu发起中断。
- IO通道控制方式：IO通道控制方式可以传输不连续的数据块，减少了cpu干预。（也是内存和外设之间的信息传输）



#### 6.5 与设备无关性的I/O软件（了解）

##### 设备分配

设备控制表DCT结构：

- 设备队列队首指针
- 忙/闲标志
- 与设备连接的控制器表指针
- 重复执行次数

#### 6.6 用户层的I/O软件

##### 假脱机(Spooling)系统

- 输入井和输出井
- 输入缓冲区和输出缓冲区
- 输入进程和输出进程
- 井管理程序

#### 6.7 缓冲区管理

##### 缓冲区的引入

- 缓和CPU与I/O设备间速度不匹配的矛盾
- 减少对CPU的中断频率，放宽对CPU中断响应时间的限制

##### 单缓冲区和双缓冲区（重点）

单缓冲区：每当用户进程发出一I/O请求时，操作系统便在主存中为之分配一缓冲区。

双缓冲区：也叫缓冲对换。由于缓冲区是共享资源，生产者和消费者在使用缓冲区时必须互斥。如果消费者尚未取走缓冲区中的数据，即使生产者又产生新的数据，也无法将它送入缓冲区，生产者等待。如果为其设置两个缓冲区，便能解决这个问题。

##### 环形缓冲区

##### 缓冲池

##### 缓冲区设计方式

当数据到达率与离去率相差很大时，可采用**单缓冲**方式。

当信息输入和输出率相同（或相差不大）时，可利用**双缓冲区**，实现两者的并行。

对于阵发性的输入、输出，为了解决速度不匹配问题，可设立**多个缓冲区**。

#### 6.8 磁盘存储器的性能和调度

##### 磁盘性能描述

##### 磁盘地址结构

柱面号、盘面号、扇面号

##### 磁盘（移臂）调度算法

- 先来先服务（FCFS）
- **最短寻道时间优先（SSTF）**
- **扫描算法（SCAN/电梯算法）**
- 循环扫描(CSCAN)算法
- NStepSCAN和FSCAN调度算法

#### 例题

对磁盘进行移臂操作是为了缩短**寻道**时间。

磁盘驱动调度算法中**先来先服务**算法可能会随时改变移动臂的运动方向。

**字节多路通道**用作链接大量的低速或中速I/O设备。 

通道又称**I/O处理机**，用于实现内存与外设之间的信息传输。

在设备管理中，是由**设备驱动程序**完成真正的I/O操作的。

磁盘的I/O管理主要采用**DMA方式**。

在Spooling 系统中，作业执行时，从磁盘上的**输入井**中读取信息，并把作业的执行结构暂时存放到磁盘的**输出井**中。

**DMA方式和中断控制方式**的主要区别

（1）中断控制方式在**每个数据传送完成后**中断CPU，而DMA控制方式则所在要求传送的一批数据全部传送结束时中断CPU。

（2）中断控制方式的数据传送在中断处理时由**CPU控制完成**，而DMA控制方式则在**DMA控制器**的控制下完成。不过，在DMA控制方式中，数据传送的方向、存放数据的内存始址以及传送数据的长度等仍然由CPU控制。

（3）DMA方式**以存储器为核心**，中断控制方式以CPU为核心。因此DMA方式能和CPU并行工作。

（4）DMA方式传输批量的数据，中断控制方式的传输则**以字节为单位**。

**DMA方式和通道方式**的主要区别

在DMA控制方式中，在DMA控制器控制下设备和主存之间可以成批地进行数据交换而不用CPU干预，这样既减轻了CPU的负担，又大大提高了I/O数据传送的速度。通道控制方式与DMA控制方式类似，也是种以内存为中心实现设备与内存直接交换数据的控制方式。	不过在通道控制方式中，**CPU只需发送启动指令**，指出通道对应的操作和I/O设备，该指令就可以启动通道并使通道从内存中调出相应的通道程序执行。与DMA控制方式相比，**通道控制方式所需的CPU干预更少**，并且一个通道可以控制多台设备，进一步减轻了CPU的负担。另外，对通道来说，可以使用一些指令灵活改变通道程序，这一点DMA控制方式无法做到。



### 第七章 文件管理

#### 7.1 文件和文件系统

基于文件系统的概念，可以把数据组成分为**数据项、记录和文件**三级。

##### 记录的成组和分解

（1）把若干逻辑记录合并成一组，存入一个物理块的工作称为记录的成组。

（2）从一组中把一个逻辑记录分离出来的工作叫做记录的分解。

##### 文件类型

按用途分类：系统文件、用户文件、库文件

按文件中的数据形式分类：源文件、目标文件、可执行文件

按存储控制属性分类：只执行文件、只读文件、读写文件

按组织形式和处理方式分类：普通文件、目录文件、特殊文件 

##### 功能

- 文件管理
- 目录管理
- 文件空间管理
- 文件共享和保护
- 提供方便的接口

从用户的观点看，操作系统中引入文件系统的目的是**实现对文件的按名存取**。

从系统的角度看，文件系统负责对文件的存储空间进行**组织、分配**，负责文件的存储并对存入文件进行**保护、检索**。 

##### 文件存储空间管理

- 空闲表法
- 空闲链表法
- 位示图法 

#### 7.2 文件的逻辑结构

##### 无结构文件（流式文件）

 ##### 有结构文件（记录式文件）

- 顺序文件  
- 索引文件
- 索引顺序文件

文件的物理结构分为**连续文件、链接文件和索引文件**。

文件的逻辑结构分为**顺序文件、索引文件和索引顺序文件。**

文件的逻辑结构是为了**方便用户**而设计的。

#### 7.3 文件目录（重点）

文件系统在创建一个文件时，为它创建一个**文件控制项（FCB）**。

##### 文件控制块

在文件系统内部给每个文件唯一地设置一个文件控制块，用于**描述和控制文件的数据结构**，与文件一一对应。

基本信息包括：（1）文件名；（2）文件物理位置；（3）文件逻辑结构；（4）文件物理结构

##### 目录结构

- 单级目录
- 二级目录
- 树形目录
- 图形目录

#### 7.4 文件共享（重点：索引结点实现）

##### 基于有向无环图实现文件共享

- 有向无环图DAG
- 索引结点（重点）
  - owner = c ： 表示文件的拥有者为c
  - count = k ：表示有k个用户目录项连接到本文件上，或者是说有三个用户共享此文件。

##### 利用符号链接实现文件共享

#### 例题

在文件系统中，文件的不同物理结构有不同的优缺点。在下列文件的物理结构中，**链接结构**不具有直接读写文件任意一个记录的能力，**顺序结构**不利于文件长度动态增长。

位示图法可用于**磁盘空闲盘块的分配和回收**。

操作系统中负责操纵和管理文件的一整套设施，它实现文件的共享和保护，方便用户**“按名存取”**

文件系统最基本的目标是**按名存取**。

在UNIX系统中，文件共享有两种方式：**符号链接和硬链接**。

【例题】有一个顺序文件含有10000条记录，平均查找的记录位数5000个，采用索引顺序文件结构，则最好情况下平均只需查找**100次**记录。

解：$\sqrt{10000}=100组，每组对应100个文件，平均查找50次，50+50=100。$

#### 

### 第八章 磁盘存储器

#### 8.1 外存的组织方式

##### 连续组织方式

##### 链接组织方式

##### FAT技术

##### NTFS的文件组织方式

##### 索引组织方式（重点混合索引）

#### 8.2 文件存储空间的管理

##### 空闲表法和空闲链表法

##### 位示图法

##### 成组链接法（重点）

####  例题

文件系统中常用的辅存空间管理方法有**①位示图；②空白文件目录；③存储块链（成组块链）**。

位示图方法可用于**硬盘空间的管理**。

UNIX文件系统对磁盘空间的管理采用**空闲块成组链接法**。

对文件空闲存储空间的管理，在MS-DOS中采用**文件分配表**。

MS-DOS系统中的磁盘文件物理结构属于**链接文件**。

每个索引文件都至少有一张索引表，其中的每一个表项应包括能识别该记录的**记录键**和该记录的**物理地址**。

**MS-DOS系统**中的磁盘文件物理结构属于链接文件**（显式链接）**；UNIX文件系统的主要特点是：文件系统组织是**分级树形结构**；文件的物理结构为**混合索引式文件结构**；采用**成组链接法**管理磁盘空闲盘块。



### 第九章 操作系统接口

#### 9.4 系统调用的概念和类型

##### 系统态和用户态

##### 系统调用

##### 中断机制



#### 例题

操作系统提供给用户的接口有**用户命令**和**程序接口**。

用户是通过**访管指令**请求操作系统服务的。

中央处理器处于目态时，执行**特权指令**将产生”非法操作“事件。

# 题集

##### 简述多级反馈队列调度算法

- 进程在进入待调度的队列等待，首先进入优先级最高的Q1等待。
- 首先调度优先级高的队列中的进程。若高优先级中队列已没有调度的进程，则调度次优优先级队列中的进程。例如，Q1,Q2,Q3三个队列，只有在Q1中没有进程等待时采取调度Q2，同理，只有Q1,Q2都为空时才会去调度Q3。
- 对于同一个队列中的各个进程，按照时间片轮转法调度。比如Q1队列的时间片为N，那么Q1中的作业在经历了N个时间片后若还没有完成，则进入Q2队列等待，若Q2的时间片用完后作业还不能完成，一直进入下一级队列，直到完成。
- 在低优先级的队列中的进程在运行时，又有新到达的作业，那么在运行完这个时间片后，CPU马上分配给新到达的作业（抢占式）。

##### 进程控制块包含哪些类型的信息？操作系统中为什么要引入线程？

进程控制块包含三类信息

（1）进程标识信息：进程ID、父进程ID、用户ID等

（2）处理器状态信息：寄存器、堆栈指针、处理器状态字等

（3）进程控制信息：调度和状态信息、进程间通信信息、资源使用信息

**传统进程具有以下弱点**：进程并发执行需要执行以下操作：创建进程、撤销进程、进程切换。由于进程是一个资源拥有者，因而在进程的创建、撤销、切换中系统必须为之付出较大的时空开销。限制了系统中的最大进程数，也限制了进程的切换频率。也就限制了并发程序的进一步提高。（要点：并发性受限、调度开销大）

**线程相对进程具有以下优点**：（1）线程的创建、撤销、调度切换中系统时空开销比进程小的多。（2）提高了系统的并发性；（3）同一进程的线程间不需要复杂的通讯机制。（4）简化了用户程序的结构设计。

##### 将文件目录分成基本文件目录和符号文件目录有哪些优点？

（1）提高目录检索速度：使一个磁盘块可以存放更多的目录项，减少目录检索中的磁盘I/O次数，大幅度提高目录检索速度。

（2）便于文件共享：一个文件可以设置多个文件名，即共用一个基本文件目录。

##### 分页存储管理和分段存储管理的主要区别有哪些？

（1）段是信息的逻辑单位，分段是出于作业逻辑上的要求，对用户来说，分段是可见的。页是信息的物理单位，分页不是作业的要求，仅是为了系统管理主存的方便，分页对用户是透明的。

（2）页的大小固定，由系统决定。段的大小不固定，由用户决定。

（3）硬件负责把逻辑地址分为页号和位移量。页号超过页表长度时产生地址越界中断。对于分段管理，段号超过段表长或位移量超过段长都会产生越界中断。

（4）从用户的角度，分页的地址空间仍是一维的，而分段的地址空间是二维的。从系统的角度，它们的地址空间都是二维的。

##### 什么是进程？什么是线程？进程与线程有何区别？

（1）进程是具有独立功能程序在某个数据集合上的一次执行过程。

（2）线程是进程内的一个执行实体或执行单元。

（3）进程和线程的区别：a.不同进程的地址空间是独立的，而同一进程内的线程共享同一地址空间。一个进程的线程在另一个进程内是不可见的。b.在引入线程的操作系统中，进程是资源分配和调度的单位，线程是处理机调度和分配的单位，资源是分配给进程的，线程只拥有很少资源，因而切换代价比进程切换低。



# 课后习题

### 第二章

##### 什么是前趋图？为什么要引入前趋图？

前趋图 (Precedence Graph) 是一个有向无循环图(DAG)，用于描述进程之间执行的前后关系。

##### 为什么程序并发执行时会产生间断性特征？

程序在并发执行时，由于它们共享资源，为完成同一项任务需要相互合作，致使这些并发执行的进程之间，形成了相互制约关系，从而使得进程在执行期间产生间断性。

##### 程序并发执行时为什么会失去封闭性和可再现性？

程序并发执行时，多个程序共享系统中的各种资源，因而这些资源的状态由多个程序改变，致使程序运行失去了封闭性，也会导致其失去可再现性。	

##### 在操作系统中为什么要引入进程概念？它会产生什么样的影响？

为了使操作系统在多道程序环境下能并发执行，并对并发执行的程序加以描述和控制，在操作系统中引入了进程概念。影响：使程序的并发执行得以实行。

##### 试从动态性、并发性和独立性上比较进程和程序

（1）动态性是进程的最基本特征，表现为由创建而产生，由调度而执行，因得不到资源而暂停执行，由撤销而消亡。进程有一定的生命期，而程序只是一组有序的指令集合，是静态实体。

（2）并发性是进程的重要特征，同时也是OS的重要特征。引入进程的目的正是为了使其程序能和其他进程的程序并发执行，而程序是不能并发执行的。

（3）独立性是指进程实体是一个能够独立运行的基本单位，也是系统中独立获得资源和独立调度的基本单位。对于未建立任何进程的程序，不能作为独立单位参加运行。

##### 试说明PCB的作用，文明史说PCB是进程存在的唯一标志？

PCB是进程实体的一部分，是操作系统中最重要的记录型数据结构。作用是使一个在多道程序环境下不能独立运行的程序，成为一个能独立运行的基本单位，成为能与其他进程并发执行的进程。OS是根据PCB对并发执行的进程进行控制和管理的。

##### PCB提供了进程管理和进程调度所需要的哪些信息？

进程管理：通用寄存器、指令计数器、程序状态字、用户栈指针

进程调度：进程状态、进程优先级、事件、其他信息

##### 进程控制块的组织方式有哪几种？

线性方式、链接方式、索引方式

##### 何谓操作系统内核？内核的主要功能是说明？

看书。

#####  试说明进程在三个基本状态之间转换的典型原因

（1）就绪->执行：进程分配到CPU资源

（2）执行->就绪：时间片用完

（3）执行->阻塞：I/O请求

（4）阻塞->就绪：I/O完成

##### 为什么要引入挂起状态？该状态有哪些性质？

引入挂起状态处于五种不同的需要：终端用户需要；父进程需要；操作系统需要；对换需要和负荷调节需要。处于挂起状态的进程不能接收处理机调度。

##### 在进行进程切换时，所要保存的处理机状态信息有哪些？

进行进程切换时，所要保存的处理机状态信息有：（1）进程当前暂存信息；（2）下一指令地址信息；（3）进程状态信息；（4）过程和系统调用参数及调用地址信息。

##### 试说明引起进程创建的主要事件

引起进程创建的主要事件有：用户登录、作业调度、提供服务、应用请求。

##### 试说明引起进程被撤销的主要事件

引起进程被撤销的主要事件有：正常结束、异常结束（越界错误、保护错、非法指令、特权指令错、运行超时、等待超时、算术运算错、I/O故障）、外界干预（操作员或操作系统干预、父进程请求、父进程终止）

##### 在创建一个进程时所要完成的主要工作是什么？

（1）OS发现请求创建新进程事件后，调用进程创建原语Creat()

（2）申请空白PCB

（3）为新进程分配资源

（4）初始化进程控制块

（5）将新进程插入就绪队列

##### 在撤销一个进程时所需要完成的主要工作是？

（1）根据被终止进程标识符，从PCB集中检索出进程PCB，读出该进程状态。

（2）若被终止进程处于执行状态，立即终止该进程的执行，置调度标志真，指示该进程被终止后重新调度。

（3）若该进程还有子进程，应将所有子孙进程终止，以防它们成为不可控进程。

（4）将被终止进程拥有的全部资源，归还给父进程，或归还给系统。

（5）将被终止进程PCB从所在队列或列表中移出，等待其他程序搜集信息。

##### 试说明引起进程阻塞或被唤醒的主要事件

（1）请求系统服务；（2）启动某种操作；（3）新数据尚未到来；（4）无工作可做。

##### 为什么要在OS中引入线程？

在操作系统中引入线程，则是为了减少程序在并发执行中所付出的时空开销，使OS具有更好的并发性，提高CPU的利用率。进程是分配资源的基本单位，而线程则是系统调度的基本单位。

##### 是说明线程有哪些属性

（1）轻型实体

（2）独立调度和分派的基本单位

（3）可并发执行

（4）共享进程资源

##### 试从调度性，并取性，拥有资源及系统开销方面对进程和线程进行比较

（1）调度性。线程在OS中作为调度和分派的基本单位，进程只作为资源拥有的基本单位。

（2）并发性。进程可以并发执行，一个进程的多个线程也可以并发执行。

（3）拥有资源。进程始终是拥有资源的基本单位，线程只拥有运行时必不可少的资源，本身基本不具有系统资源，但可以访问隶属进程的资源。

（4）系统开销。操作系统在创建、撤销和切换进程时付出的开销显著大于线程。

##### 何谓用户级线程和内核支持线程？

（1）用户级线程：仅存在于用户空间中的线程，无需内核支持。这种线程的创建、撤销、线程间的同步与通信等功能，都无需利用系统调度实现。用户级线程的切换通常发生在一个应用程序的诸多线程之中，同样无需内核支持。

（2）内核支持线程：在内核支持下运行的线程。无论是用户进程中的线程，还是系统线程中的线程，其创建、撤销和切换等都是依靠内核，在内核空间中实现的。在内核空间里还为每个内核支持线程设置了线程控制块，内核根据该控制块感知某线程的存在并实施控制。



##### 试说明用户及线程的实现方法

##### 试说明内核支持线程的实现方法

##### 多线程模型有哪几种类型？多对一模型有何优缺点？



### 第三章

##### 1.高级调度和低级调度的主要任务是什么？为什么要引入中级调度？

高级调度的主要任务是根据某种算法，把外存上处于后被队列的那些作业调入内存。低级调度是保存处理机的现场信息，按某种算法先取进程，再把处理机分配给进程。

引入中级调度的主要目的是为了提高内存利用率和系统吞吐量。使那些暂时不能运行的进程不再占用内存资源，将它们调至外存等待，把进程状态改为就绪驻外存状态或挂起状态。

##### 2.处理机调度算法的共同目标是什么？批处理系统的调度目标又是什么？

共同目标：资源利用率，公平性，平衡性，策略强制执行。

批处理系统的调度目标：平均周转时间短，系统吞吐量高，处理机利用率高。

##### 3.何谓作业、作业步和作业流?

作业包括通常的程序和数据，还配有作业说明书。系统根据该说明书对程序的运行进行控制。批处理系统是以作业为基本单位从外存调入内存的。

作业步是指每个作业运行期间都必须经过若干个相对独立相互关联的顺序加工的步骤。

作业流是指若干作业进入系统后依次存放在外存上形成的输入作业流；在操作系统的控制下，逐个作业进程处理，于是形成了处理作业流。

##### 4.在什么情况下需要使用作业控制块JCB？其中包含了哪些内容?

每当作业进入系统时，系统便为每个作业建立一个作业控制块JCB，根据作业类型将它插入到相应的后被队列中。JCB包含的内容通常有：1）作业标识；2）用户名称；3）用户账号；4）作业类型（CPU繁忙型、I/O繁忙型、批量型、终端型）；5）作业状态；6）调度信息（优先级、作业已运行）；7）资源要求；8）进入系统时间；9）开始处理时间；10）作业完成时间；11）作业退出时间；12）资源使用情况等

##### 5.在作业调度中应如何确定接纳多少个作业和接纳哪些作业？

作业调度每次接纳进入内存的作业书，取悦于多道程序度。应将哪些作业从外存调入内存，取决于采用的调度算法。最简单的是先来先服务调度算法，较常用的是短作业优先算法和基于作业优先级的调度算法。

##### 6.试说明低级调度的主要功能？

（1）保存处理机的现场信息

（2）按某种算法选取进程

（3）把处理机分配给进程

##### 7.在抢占调度方式中，抢占的原则是什么？

时间片原则、优先权原则、短作业优先权原则

##### 8.在选择调度方式和调度算法时，应遵循的准则是什么？

（1）面向用户的准则：周转时间短、响应时间快、截止时间的保证、优先权准则。

（2）面向系统的准则：系统吞吐量高、处理机利用率好、各类资源的平衡利用。

##### 9.在批处理系统、分时系统和实时系统中，各采用哪几种进程（作业）调度算法？

批处理系统的调度算法：短作业优先、优先权优先、高响应比优先、多级反馈队列调度算法。

分时系统的调度算法：时间片轮转法

实时系统的调度算法：最早截止时间优先（EDF），最低松弛度优（LLF）

##### 10.何谓静态优先级和动态优先级？确定静态优先级的依据是什么？

##### 11.试比较FCFS和SPF两种进程调度算法。

##### 12.在时间片轮转法中，应如何确定时间片的大小？

时间片应略大于依次典型的交互需要时间。一般应考虑三个因素：系统对对应时间的要求、就绪队列中进程的数目和系统的处理能力。

##### 14.通过一个例子来说明通常的优先级调度算法不能适用于实时系统？

  答：实时系统的调度算法很多，主要是基于任务的开始截止时间和任务紧急/松弛程度的任务优先级调度算法，通常的优先级调度算法不能满足实时系统的调度实时性要求而不适用。

##### 15.为什么说多级反馈队列调度算法能较好地满足各方面用户的需要？

  答：终端型用户：由于终端型用户提交的作业多属于交互型作业，通常较小，系统只要能使这些作业在第一队列规定的时间片内完成，便可使终端型用户感到满意

  短批处理作业用户：对于这类作业，如果可在第一队列中执行完成，便获得与终端型作业一样的响应时间。对于稍长的短作业，也只需在第二和第三队列各执行一时间片完成，其周转时间仍然较短。

​     长批处理作业用户：对于长作业，它将依次在第1，2，……n个队列中运行，然后再按轮转方式运行，用户不必担心其作业长期得不到处理。

##### 16.为什么说传统的几种调度算法都不能算是公平调度算法？

  答： 以上介绍的几种调度算法所保证的只是优先运行，如优先级算法是优先级最高的作业优先运行，但并不保证作业占用了多少处理机时间。另外也未考虑到调度的公平性。

#####  17.保证调度算法是如何做到调度的公平性的？

  答：保证调度算法是另外一种类型的调度算法，它向用户所做出的保证并不是优先运行，而是明确的性能保证，该算法可以做到调度的公平性。

　　一种比较容易实现的性能保证是处理机分配的公平性。如果在系统中有n个相同类型的进程同时运行，为公平起见，须保证每个进程都获得相同的处理机时间1/n。

##### 18.公平分享调度算法又是如何做到调度的公平性的？

  答： 在公平分享调度算法中，调度的公平性主要是针对用户而言，使所有用户能获得相同的处理机时间，或所要求的时间比例。

##### 19.为什么在实时系统中，要求系统（尤其是CPU)有较强的处理能力？

  答：在实时系统中，不但包括周期任务、偶发任务、非周期任务，还包括非实时任务。实时任务要求要满足时限，而非实时任务要求要使其响应时间尽可能的短。

  　 多种类型任务的混合，使系统的可调度性分析更加困难。实际上有些实时系统CPU处理能力并不强，比如一些嵌入式实时系统，这就要求系统尽量少做一些并发计算任务，留出足够冗余处理实时任务。

##### 20.按调度方式可将实时调度算法分为哪几种？

  答：按调度方式不同，可分为非抢占调度算法和抢占调度算法两种。

##### 21.什么是最早截止时间优先调度算法，请举例说明之。

  答：根据任务的开始截止时间确定的任务优先级调度算法。截止时间越早则优先级越高。该算法要求在系统中保持一个实时任务就绪队列，该队列按各任务截止时间的先后排序。

##### 22.什么是最低松弛度优先调度算法，请举例说明之。

  答：该算法是根据任务的紧急（或松弛）程度，来确定任务的优先级。任务的紧急程度越高，为该任务所赋予的优先级就越高，以使之优先执行。

  　 例如，一个任务在200ms时必须完成，而它本身所需的运行时间就有100ms，因此，调度程序必须在100ms之前调度执行，该任务的紧急程度（松弛程度）为100ms。

　　　又如，另一任务在400ms时必须完成，它本身需要运行150ms，则其松弛程度为250ms。

  　　最早截止时间优先调度算法：任务要求的截止时间越早，其优先级就越高。

  　 最低松弛度优先调度算法：任务的紧急程度越高，其优先级就越高。

##### 23.何谓“优先级倒置”现象，可采取什么方法来解决？

  答：当前OS广泛采用优先级调度算法和抢占方式，然而在系统中存在着影响进程运行的资源而可能产生“优先级倒置”的现象，即高优先级进程（或线程）被低优先级进程（或线程）延迟或阻塞。

##### 24.试分别说明可重用资源和可消耗资源的性质。

  答： 可重用性资源：每一个可重用性资源中的单元只能分配给一个进程使用，不允许多个进程共享。进程在使用可重用性资源时，须按照这样的顺序：请求资源、使用资源、释放资源。

　　系统中每一类可重用性资源中的单元数目是相对固定的，进程在运行期间既不能创建也不能删除它。

​      可消耗性资源：每一类可消耗性资源的单元数目在进程运行期间是可以不断变化的，有时它可以有许多，有时可能为0。进程在运行过程中，可以不断创造可消耗性资源的单元，将它们放入该资源类的缓冲区中，以增加该资源类的单元数目。

　　进程在运行过程中，可以请求若干个可消耗性资源单元，用于进程自己的消耗，不再将它们返回给该资源类中。



### 第四章

##### 1.为什么要配置层次式存储器

- 设置多个存储器可以使存储器两端的硬件能并行工作。
- 采用多级存储系统，特别是Cache技术，这是一种减轻存储器带宽对系统性能影响的最佳结构方案。
- 在微处理机内部设置各种缓冲存储器，以减轻对存储器存储的压力。增加CPU中存储器的数量，也可大大缓解对存储器的压力。

##### 2.可采用哪几种方式将程序装入内存？它们分别适用于何种场合？

将程序装入内存可采用的方式有：绝对装入方式、重定位装入方式、动态运行时装入方式；绝对装入装入方式适用于单道程序环境中，重定位装入方式和动态运行时装入方式适用于多道程序环境中。

##### 3.何为静态链接？静态链接时需要解决两个什么问题？

静态链接是指在程序运行之前，先将各自目标模块及它们所需的库函数，链接成一个完整的装入模块，以后不再拆开的链接方式。

将几个目标链接装配成一个装入模块时，需解决以下两个问题：

①将相对地址进行修改。即将出第一个模块外的相对地址修改成装入模块中的相应的相对地址。

②变换外部调用符号。即将每个模块中所用的外部调用符号，都变换为相对地址。

##### 4.何谓装入时动态链接？装入时动态链接方式有何优点？

装入时动态链接是指将用户源程序编译后所得到的一组目标模块，在装入内存时，采用边装入边链接的一种链接方式，即在装入一个目标模块时，若发生一个外部模块调用事件，将引起装入程序去找相应的外部目标模块，把它装入内存中，并修改目标模块中的相对地址。装入时动态链接方式的以下优点：

- 便于修改和更新
- 便于实现对目标模块的共享

##### 5.何谓运行时动态链接？运行时动态链接方式有何优点？

运行时动态链接是将对某些模块的链接推迟到程序执行时才进行链接，也就是，在执行过程中，当发现一个被调用模块尚未装入内存时，立即由OS去找到该模块并将之装入内存，把它链接到调用者模块上。
　　优点：凡是在执行过程中未被用过的目标模块，都不会被调入内存和被链接到装入模块上，这样不仅能加快程序的装入过程，而且可节省大量的内存空间。

##### 6.在动态分区分配方式中，应如何将各空闲分区链接成空闲分区链?
答：应在每个分区的起始地址部分，设置一些用于控制分区分配的信息，以及用于链接各分区的前向指针；在分区尾部则设置一后向指针，通过前，后向指针将所有的分区链接成一个双向链. P128图4-7。主要使用双向链表。

##### 7.为什么要引入动态重定位？如何实现？
答：a.程序在运行过程中经常要在内存中移动位置，为了保证这些被移动了的程序还能正常执行，必须对程序和数据的地址加以修改，即重定位。引入重定位的目的就是为了满足程序的这种需要。
　　b.要在不影响指令执行速度的同时实现地址变换，必须有硬件地址变换机构的支持，即须在系统中增设一个重定位寄存器，用它来存放程序在内存中的起始地址。程序在执行时，真正访问的内存地址是相对地址与重定位寄存器中的地址相加而形成的。

##### 8.什么是基于顺序搜索的动态分区分配算法？它可分为哪几种？
答：为了实现动态分区式分配，将系统中的空闲分区组织成空闲分区表或空闲分区链。所谓顺序搜索，是指按表或链的组织顺序，

　　检索表或链上记录的空闲分区，去寻找一个最符合算法的、大小能满足要求的分区。分区存储管理中常采用的分配策略有：首次适应算法、循环首次适应算法、最佳适应算法、最坏适应算法。
##### 9.在采用首次适应算法回收内存时，可能出现哪几种情况？应怎样处理这些情况？
答：a.回收区与插入点的前一个分区相邻接，此时可将回收区与插入点的前一分区合并，不再为回收分区分配新表项，而只修改前邻接分区的大小；

　　b.回收分区与插入点的后一分区相邻接，此时合并两区，然后用回收区的首址作为新空闲区的首址，大小为两者之和：
　　c.回收区同时与插入点的前后两个分区邻接，此时将三个分区合并，使用前邻接分区的首址，大小为三区之和，取消后邻接分区的表项；

　　d.回收区没有邻接空闲分区，则应为回收区单独建立一个新表项，填写回收区的首址和大小，并根据其首址，插入到空闲链中的适当位置.
##### 10.什么是基于索引搜索的动态分区分配算法？它可分为哪几种？
答：P131.快速适应算法、伙伴系统、哈希算法

##### 11.令buddyK(x)表示大小为2的k次方、地址为x的块的伙伴系统地址，试写出buddyK（x)通用表达式？
答：P126。考研的同学可以关注一下。Buddy System是一种经典的内存管理算法，在Unix和Linux操作系统中都有用到，其作用是减少存储空间中的空洞，减少碎片，增加利用率。在有的“数据结构”课本中有算法介绍。
　　这道题我看不懂其题意，大概是分配内存时x要找的空闲块是：
　　pow（2，k-1)<=buddyK(x)<=pow(2,k)//pow是乘方函数Buddy System是一种连续的内存管理方法，可以结合离散的分页分配方法使用，有利于为进程分配连续的物理块，以提高分页法的效率和程序的局部性。

##### 12.分区存储管理中常采用哪些分配策略?比较它们的优缺点。
答：分区存储管理中常采用的分配策略有：首次适应算法、循环首次适应算法、最佳适应算法、最坏适应算法。
　　a.首次适应算法的优缺点：保留了高址部分的大空闲区，有利于后到来的大型作业的分配；低址部分不断被划分，留下许多难以利用的、小的空闲区，且每次分区分配查找时都是从低址部分开始，会增加查找时的系统开销。
　　b.循环首次适应算法的优缺点：使内存中的空闲分区分布得更为均匀，减少了查找时的系统开销；缺乏大的空闲分区，从而导致不能装入大型作业。
　　c.最佳适应算法的优缺点：每次分配给文件的都是最适合该文件大小的分区；内存中留下许多难以利用的小的空闲区。
　　d.最坏适应算法的优缺点：给文件分配分区后剩下的的空闲区不至于太小，产生碎片的几率最小，对中小型文件分配分区操作有利；使存储器中缺乏大的空闲区，对大型文件的分区分配不利。

##### 13.为什么要引入对换？对换可分为哪几种类型？
答：在多道环境下，一方面，在内存中的某些进程由于某事件尚未发生而被阻塞，但它却占用了大量的内存空间，甚至有时可能出现在内存中所有进程都被阻塞而迫使CPU停止下来等待的情况；

　　另一方面，却又有着许多作业在外存上等待，因无内存而不能进入内存运行的情况。显然这对系统资源是一种严重的浪费，且使系统吞吐量下降。为了解决这一问题，在操作系统中引入了**对换（也称交换）技术**。
　　可以将**整个进程**换入、换出，也可以将**进程的一部分（页、段）**换入、换出。前者主要用于缓解目前系统中内存的不足，后者主要用于实现虚拟存储。

##### 14.对文件区管理的目标和对对换空间管理的目标有何不同？
答：对文件区管理的主要目标是提高文件存储空间的利用率，然后才提高对文件的访问速度，因此，对文件区空间的管理采取离散分配方式。
　　对对换空间管理的主要目标是提高进程换入和换出的速度，然后才是提高文件存储空间的利用率，因此，对对换区空间的管理采取连续分配方式，较少的考虑外存中的碎片问题。

##### 15.为实现对换，系统应具备哪几方面功能?
答：系统应具备三方面功能：对换空间管理，进程换出，进程换入。
##### 16.在以进程为单位进行对换时，每次是否将整个进程换出？为什么？
答：在以进程为单位进行对换时，并非每次将整个进程换出。这是因为：
　　a.从结构上讲，进程是由程序段、数据段和进程控制块组成的，其中进程控制块总有部分或全部常驻内存，不被换出。
　　b.程序段和数据段可能正被若干进程共享，此时它们也不能被换出。

##### 17.基于离散分配时所用的基本单位不同，可将离散分配分为哪几种？
答：分页存储管理方式、分段存储管理方式和段页式存储管理方式。

##### 18.什么是页面?什么是物理块?页面的大小应如何确定？
答：页面：分页存储管理将进程的逻辑地址空间分成若干个页，并为各页加以编号。物理块：把内存的物理地址空间分成若干个块，并为各块加以编号。页面大小应选择适中，且页面大小应该是2的幂，通常为1KB~8KB。
##### 19.什么是页表?页表的作用是什么？
答：页表是分页式存储管理使用的数据结构。一个进程分为多少页，它的页表就有多少行。每一行记录进程的一页和它存放的物理块的页号、块号对应关系。页表用于进行地址变换。
##### 20.为实现分页存储管理，需要哪些硬件支持?
答：需要有页表机制、地址变换机构的硬件支持。
##### 21.在分页系统中是如何实现地址变换的？
答：利用地址变换机构实现从逻辑地址到物理地址的转变换，通过页表来实现从页号到物理块号的变换，将逻辑地址中的页号转换为内存中的物理块号。
##### 22.具有快表时是如何实现地址变换的？
##### 23.较详细的说明引入分段存储管理方式是为了满足用户哪几个方面的需求。
答：1）方便编程。用户通常把自己的作业按照逻辑关系划分为若干段，每段都从0编址，并有自己名字和长度。因此，希望要访问的逻辑地址是由段名和段内偏移量决定。
　　2）信息共享。在实现对程序和数据的共享时，是以信息逻辑单位为基础。
　　分页系统中的页是存放信息的物理单位，无完整意义，不便于共享；段是信息的逻辑单位。为了实现段的共享，希望存储管理能与用户程序分段的组织方式相适

​		3）信息保护。对信息的逻辑单位进行保护，分段能更有效方便地实现信息保护功能。
　　4）动态增长。在实际应用中，有些段特别是数据段，在使用过程中会不断增长，事先又无法确切知道增长多少。分段存储管理方式能较好解决这个问题

　　5）动态链接。运行时先将主程序对应的目标程序装入内存并启动运行，运行过程中又需要调用某段时，才将该段调入内存链接。所以动态链接也要求以段作为管理单位。
24.在具有快表的段页式存储管理方式中，如何实现地址变换?
答：在CPU给出有效地址后，由地址变换机构自动将页号P送入高速缓冲寄存器，并将此页号与高速缓存中的所有页号比较，若找到匹配页号，表示要访问的页表项在快表中。

可直接从快表读出该页对应物理块号，送到物理地址寄存器中。如快表中没有对应页表项，则再访问内存页表，找到后，把从页表项中读出物理块号送地址寄存器；

同时修改快表，将此页表项存入快表。但若寄存器已满，则0S必须找到合适的页表项换出。

##### 25.为什么说分段系统较之分页系统更易于实现信息共享和保护？
答：a.对于分页系统，每个页面是分散存储的，为了实现信息共享和保护，则页面之间需要一一对应起来，为此需要建立大量的页表项；

　　b.而对于分段系统，每个段都从0开始编址，并采用一段连续的地址空间，这样在实现共享和保护时，只需为所要共享和保护的程序设置一个段表项，将其中的基址与内存地址一一对应起来即可。
##### 26.分页和分段有何区别?
答：a.分页和分段都采用离散分配的方式，且都要通过地址映射机构来实现地址变换，这是它们的共同点；

　　b.对于它们的不同点有三，第一，从功能上看，页是信息的物理单位，分页是为实现离散分配方式，以消减内存的外零头，提高内存的利用率，即满足系统管理的需要，而不是用户的需要；

　　而段是信息的逻辑单位，它含有一组其意义相对完整的信息，目的是为了能更好地满足用户的需要；

　　第二页的大小固定且由系统确定，而段的长度却不固定，决定于用户所编写的程序；第三分页的作业地址空间是一维的，而分段的作业地址空间是二维的。
27.试全面比较连续分配和离散分配方式.
答：a.连续分配是指为一个用户程序分配一个连续的地址空间，包括单一连续分配方式和分区式分配方式，前者将内存分为系统区和用户区，系统区供操作系统使用，用户区供用户使用，是最简单的一种存储方式，但只能用于单用户单任务的操作系统中；

分区式分配方式分为固定分区和动态分区，固定分区是最简单的多道程序的存储管理方式，由于每个分区的大小固定，必然会造成存储空间的浪费；

动态分区是根据进程的实际需要，动态地为之分配连续的内存空间，常用三种分配算法：首次适应算法，该法容易留下许多难以利用的小空闲分区，加大查找开销；循环首次适应算法，该算法能使内存中的空闲分区分布均匀，但会致使缺少大的空闲分区；

最佳适应算法，该算法也易留下许多难以利用的小空闲区；b.离散分配方式基于将一个进程直接分散地分配到许多不相邻的分区中的思想，分为分页式存储管理，分段存储管理和段页式存储管理.分页式存储管理旨在提高内存利用率，满足系统管理的需要，

分段式存储管理则旨在满足用户（程序员）的需要，在实现共享和保护方面优于分页式存储管理，而段页式存储管理则是将两者结合起来，取长补短，即具有分段系统便于实现，可共享，易于保护，可动态链接等优点，又能像分页系统那样很好的解决

外部碎片的问题，以及为各个分段可离散分配内存等问题，显然是一种比较有效的存储管理方式；c.综上可见，连续分配方式和离散分配方式各有各自的特点，应根据实际情况加以改进和利用.



### 第五章

##### 1.常规存储器管理方式具有哪两大特征？它对系统性能有何影响？
答：一次性：进程必须全部装入内存，对空间浪费非常大；

　　驻留性：在程序运行过程中，进程全部驻留在内存，暂时不用的数据无法释放。
##### 2.什么是程序运行时的时间局限性和空间局限性？
答：(1)  时间局限性：如果程序中的某条指令一旦执行，则不久的将来该指令可能再次被执行；如果某个存储单元被访问，则不久的将来该存储单元可能再次被访问。产生时间局限性的典型原因是在程序中存在着大量的循环操作。
   （2）空间局限性：一旦程序访问了某个存储单元，则在不久的将来，其附近的存储单元也最有可能被访问，即程序在一段时间内所访问的地址，可能集中在一定的范围内。产生空间局限性的典型原因是程序是顺序执行的。

##### 3.虚拟存储器有哪些特征？其中最本质的特征是什么？
答：虚拟存储器有多次性、对换性、虚拟性三大特征。最本质的特征是虚拟性。
##### 4.实现虚拟存储器需要哪些硬件支持?
答：a. 请求分页（段）的页（段）表机制

　　b. 缺页（段）中断机构

　　c. 地址变换机构

##### 5.实现虚拟存储器需要哪几个关键技术?
答：(1）在分页请求系统中是在分页的基础上，增加了请求调页功能和页面置换功能所形成的页式虚拟存储系统。允许只装入少数页面的程序（及数据），使启动运行。

   （2）在请求分段系统中是在分段系统的基础上，增加了请求调段及分段置换功能后形成的段式虚拟存储系统。允许只装入少数段（而非所有段）的用户程序和数据，即可启动运行。
##### 6.在请求分页系统中，页表应包括哪些数据项？每项的作用是什么?
答：页表应包括：页号、物理块号、状态位P、访问字段A、修改位M和外存地址。其中状态位P指示该页是否调入内存，供程序访问时参考；

　　访问字段A用于记录本页在一段时间内被访问的次数，或最近己有多长时间未被访问，提供给置换算法选择换出页面时参考；

　　修改位M表示该页在调入内存后是否被修改过：

　　外存地址用于指出该页在外存上的地址，通常是物理块号，供调入该页时使用。
##### 7.试比较缺页中断机构与一般的中断，它们之间有何明显的区别？
答：a. 一般中断只需要保护现场然后就直接跳到需及时处理的地方。
　　b .缺页中断除了保护现场之外，还要判断内存中是否有足够的空间存储所需的页或段，然后再把所需页调进来再使用。

##### 8.试说明请求分页系统中的地址变换过程。
答：1）取逻辑地址分解为页号P和页内偏移w；

　　2）根据页号查找页表，获得该页的描述信息；

　　3）若该页中断位为1，产生缺页中断；　　

　　4）更新该页的描述信息；

　　5)  根据页块号和页内偏移w，计算物理地址。
##### 9.何谓固定分配局部置换和可变分配和全局置换的内存分配策略?

答：（1）固定分配局部置换固定分配是指，为每个进程分配一组固定数目的物理块，在进程运行期间不再改变。
　　　　局部置换是指，如果进程在运行中发现缺页，则只能从分配给该进程的n个页面中，选出一页换出，然后再调入一页。
　　（2）可变分配全局置换可变分配是指，先为每个进程分配一定数目的物理块，在进程运行期间，可根据情况做适当地改变。
　　　　全局置换是指，如果进程在运行中发现缺页，则将OS所保留的空闲物理块或者以所有进程的全部物理块为标的，选择一块换出，然后将所缺之页调入。

##### 10.在请求分页系统中，应从何处将所需页面调入内存？
答：请求分页系统中的缺页从何处调入内存分三种情况：
　　（1）系统拥有足够对换区空间时，可以全部从对换区调入所需页面，提高调页速度。在进程运行前将与该进程有关的文件从文件区拷贝到对换区。
　　（2）系统缺少足够对换区空间时，不被修改的文件直接从文件区调入：当换出这些页面时，未被修改的不必换出，再调入时，仍从文件区直接调入。对于可能修改的，在换出时便调到对换区，以后需要时再从对换区调入。
　　（3）UNIX方式。未运行页面从文件区调入。曾经运行过但被换出页面，下次从对换区调入。UNIX系统允许页面共享，某进程请求的页面有可能已调入内存，直接使用不再调入。

##### 11.试说明在请求分页系统中页面的调入过程。
答：每当程序所要访问的页面未在内存时（存在位为“0”），便向CPU发出一缺页中断，中断处理程序首先保留CPU环境，分析中断原因后，转入缺页中断处理程序。

该程序通过查找页表，得到该页在外存的物理块后，如果此时内存能容纳新页，则启动磁盘I/0，将所缺之页调入内存，然后修改页表。如果内存已满，则须先按照某种置换算法，从内存中选出一页准备换出；

如果该页未被修改过（修改位为“0”），可不必将该页写回磁盘；但如果此页已被修改（修改位为“1”），则必须将它写回磁盘，然后再把所缺的页调入内存，并修改页表中的相应表项，置其存在位为“1”，并将此页表项写入快表中。

在缺页调入内存后，利用修改后的页表，去形成所要访问数据的物理地址，再去访问内存数据。整个页面的调入过程对用户是透明的。
##### 12.在请求分页系统中，常采用哪几种页面置换算法？
答：采用的页面置换算法有：最佳置换算法和先进先出置换算法，最近最久未使用（LRU）置换算法，Clock置换算法，最少使用置换算法，页面缓冲算法等。

##### 13.在一个请求分页系统中，采用FIFO页面置换算法时，假如一个作业的页面走向为4、3、2、1、4、3、5、4、3、2、1、5，当分配给该作业的物理块数M分别为3和4时，试计算在访问过程中所发生的缺页次数和缺页率，并比较所得结果。

　　　　![img](https://img2018.cnblogs.com/i-beta/1641874/201911/1641874-20191115094650414-167212614.png)

 

　　M=3时，采用FIFO页面置换算法的缺页次数为9次，缺页率为75%；M=4时，采用FIFO页面置换算法的缺页次数为10次，缺页率为83%。
　　由此可见，增加分配给作业的内存块数，反而增加了缺页次数，提高了缺页率，这种现象被称为是Belady现象。
##### 14.实现LRU算法所需的硬件支持是什么？
答：需要寄存器和栈等硬件支持。寄存器用于记录某进程在内存中各页的使用情况，栈用于保存当前使用的各个页面的页面号。
##### 15.试说明改进型Clock置换算法的基本原理.
答：因为修改过的页面在换出时付出的开销比未被修改过的页面大，在改进型Clock算法中，既考虑页面的使用情况，还要增加置换代价的因素；在选择页面作为淘汰页面时，把同时满足未使用过和未被修改作为首选淘汰页面。
##### 16.影响页面换进换出效率的若干因素是什么？
（1）页面置换算法：影响页面换进换出效率最重要的因素，直接影响进程在运行过程中的缺页率，影响页面换进换出的开销。
（2）写回磁盘的频率：如果是采取每个页面换出时，就将它写回磁盘的策略，这意味着每换出一个页面，便需要启动一次磁盘。

　　但如果在系统中建立了一个已修改换出页面链表，对每一个要被换出的页面（已修改），系统可暂不把它们写回磁盘，而是将它们挂在已修改换出页面链表上，

　　仅当被换出页面数目达到一定值时，再将它们一起写回到磁盘上，这样就显著地减少了磁盘I/0的操作次数。或者说，减少已修改页面换出的开销。
（3）读入内存的频率：在设置了已修改换出页面链表后，在该链表上就暂时有一批装有数据的页面，如果需要再次访问这些页面时，就不需从外存上调入，

　　而直接从已修改换出页面链表中获取，这样也可以减少将页面从磁盘读入内存的频率，减少页面换进的开销。或者说，只需花费很小的开销，便可使这些页面，又回到该进程的驻留集中。

##### 17.页面缓冲算法的主要特点是什么？它是如何降低页面换进换出的频率的？

答：① 显著地降低了页面换进、换出的频率，使磁盘I/0的操作次数大为减少，因而减少了页面换进、换出的开销；

　　②由于换入换出的开销大幅度减小，才能使其采用一种较简单的置换策略，如先进先出（FIFO）算法，它不需要特殊硬件的支持，实现起来非常简单。

　　在该系统中，内存分配策略上采用了可变分配和局部置换方式。为了能显著地降低了页面换进、换出的频率，在内存中设置了如下两个链表：
　　（1）空闲页面链表：是一个空闲物理块链表，用于分配给频繁发生缺页的进程，以降低该进程的缺页率。当有一个未被修改的页要换出时，实际上并不将它换出到外存，而是把它们所在的物理块，挂在空闲链表的末尾。
　　（2）修改页面链表：由已修改的页面所形成的链表。设置该链表的目的，是为了减少已修改页面换出的次数。降低将已修该页面写回磁盘的频率，以及降低将磁盘内容读入内存的频率。
##### 18.什么是抖动? 产生抖动的原因是什么？
答：a. 抖动（Thrashing) 就是指当内存中已无空闲空间而又发生缺页中断时，需要从内存中调出一页程序或数据送磁盘的对换区中，如果算法不适当，刚被换出的页很快被访问，需重新调入，

因此需再选一页调出，而此时被换出的页很快又要被访问，因而又需将它调入，如此频繁更换页面，使得系统把大部分时间用在了页面的调进换出上，而几乎不能完成任何有效的工作，我们称这种现象为"抖动"。
　　b. 产生抖动的原因是由于CPU的利用率和多道程序度的对立统一矛盾关系引起的，为了提高CPU利用率，可提高多道程序度，但单纯提高多道程序度又会造成缺页率的急剧上升，导致CPU的利用率下降，

　　而系统的调度程序又会为了提高CPU利用率而继续提高多道程序度，形成恶性循环，我们称这时的进程是处于"抖动"状态。
##### 19.何谓工作集？它是基于什么原理确定的？
答：工作集（或驻留集）是指在某段时间间隔内，进程要访问的页面集合。经常被使用的页面需要在工作集中，而长期不被使用的页面要从工作集中被丢弃。为了防止系统出现抖动现象，需要选择合适的工作集大小。

　　工作集模型的原理是：
　　  让操作系统跟踪每个进程的工作集，并为进程分配大于其工作集的物理块。如果还有空闲物理块，则可以再调一个进程到内存以增加多道程序数。

　　  如果所有工作集之和增加以至于超过了可用物理块的总数，那么操作系统会暂停一个进程，将其页面调出并且将其物理块分配给其他进程，防止出现抖动现象。正确选择工作集的大小，对存储器的利用率和系统吞吐量的提嵩，都将产生重要影响。
##### 20.当前可以利用哪几种方法来防止“抖动”？
（1）采取局部置换策略

（2）把工作集算法融入到处理机调度中

（3）利用“L=S”准则调节缺页率

（4）选择暂停的进程

##### 21.试试说明如何利用“L=S”准则来调节缺页率，以避免“抖动”的发生?

答：P173 于1980年Denning提出了“L=S”的准则，来调节多道程序度，其中L是缺页之间的平均时间，S是平均缺页服务时间，即用于置换一个页面所需的时间。利用“L=S”准则，对于调节缺页率是十分有效的。
##### 22.为了实现请求分段式存储管理，应在系统中增加配置哪些硬件结构？
答：请求段表机制、缺段中断机制和地址变换机构。

##### 23.在请求段表机制中，应设置哪些段表项？

　　![img](https://img2018.cnblogs.com/i-beta/1641874/201911/1641874-20191115094957657-1823389832.png)

##### 24.说明请求分段系统中的缺页中断处理过程。
答：请求分段系统中的缺页中断处理过程描述如下：
　　（1)根据当前执行指令中的逻辑地址查页表，判断该页是否在主存储器中（2）该页标志为“0”形成缺页中断，中断装置通过交换PSW让操作系统的中断处理程序占用处理器。
　　（3）操作系统处理缺页中断处理的办法是查主存分配表找一个空闲的主存块，查页表找出该页在磁盘上位置，启动磁盘读出该页信息。
　　（4）把从磁盘上读出的信息装入找到的主存块中。
　　（5）当页面住处被装入主存后，应修改页表中对应的表目，填上该页所占用的主存块把标志置为“1”，表示该页已在主存储器中

　　（6）由于产生缺页中断时的那条指令并没执行完，所以在把页面装入之后应重新执行被中断指令。
请求分段系统中的缺页中断处理过程如下图所示：

　　![img](https://img2018.cnblogs.com/i-beta/1641874/201911/1641874-20191115095240458-245680898.png)

![img](https://img2018.cnblogs.com/i-beta/1641874/201911/1641874-20191115095316795-42471557.png)

##### 26.如何实现共享分段的分配和回收?
答：①共享段的分配：在为共享段分配内存时，对第一个请求使用该共享段的进程，由系统为该共享段分配一物理区，当又有其它进程需要调用该共享段时，无须再为该段分配内存。
　　②共享段的回收：当共享此段的某进程不再需要该段时，若无其他进程使用该段，则由系统回收该共享段的物理内存，否则只是取消调用者进程在共享段表中的有关记录。


### 第六章

##### 1.试说明I/0系统的基本功能。
答：a. 隐藏物理设备的细节

　　b. 与设备的无关性

　　c. 提高处理机和I/0设备的利用率

　　d. 对I/0设备进行控制

​		e.确保对设备的正确共享

　　f. 错误处理

##### 2.简要说明I/0软件的4个层次的基本功能。
答：中断处理程序：用于保存被中断进程的CPU环境，转入相应的中断处理程序进行处理，处理完后恢复现场，并返回到被中断的进程

　　设备驱动程序：与硬件直接有关，用来具体实现系统对设备发出的操作指令，驱动I/0设备工作

　　设备独立性软件：用于实现用户程序与设备驱动器的统一接口、设备命令、设备保护，以及设备分配与释放等。
　　用户层I/0软件：用于实现用户与I/O设备交互

##### 3. I/O系统接口与软件/硬件（RW/HW）接口分别是什么接口?
答：I/0系统接口是I/0系统与上层系统之间的接口，向上层提供对设备进行操作的抽象I/0命令，以方便高层对设备的使用；

软件/硬件（RW/HW）接口的上面是中断处理程序何用于不同设备的设备驱动程序，它的下面是各种设备的控制器。
##### 4.与设备无关性的基本含义是什么？为什么要设置该层？
答：为了提高OS的可适应性和可扩展性，在现代OS中都毫无例外地实现了设备独立性，也称设备无关性。

基本含义：应用程序独立于具体使用的物理设备。为了实现设备独立性而引入了逻辑设备和物理设备两概念。在应用程序中，使用逻辑设备名称来请求使用某类设备；而系统在实际执行时，还必须使用物理设备名称。

优点：1. 设备分配时的灵活性

​			2. 易于实现I/O重定向（用于I/O操作的设备可以更换（即重定向），而不必改变应用程序。

##### 5.试说明设备控制器的组成。
答：设置控制器与处理机的接口；设备控制器与设备的接口；I/O逻辑。
##### 6.为了实现CPU与设备控制器之间的通信，设备控制器应该具备哪些功能?
答：基本功能：接收和识别命令；数据交换；标识和报告设备的状态；

​        地址识别：数据缓冲；差错控制。

#### 7.什么是内存映像I/O?它是如何实现的?P1868.为什么说中断是OS赖以生存的基础?
答：中断在操作系统中有着特殊重要的地位，它是多道程序得以实现的基础，没有中断，就不可能实现多道程序，因为进程之间的切换是通过中断来完成的。

另一方面，中断也是设备管理的基础，为了提高处理机的利用率和实现CPU和I/O设备并执行，也必需有中断的支持。中断处理程序是I/O系统中最低的一层，它是整个I/O系统中最低的一层。
##### 9.对中断源的两种处理方式分别用于那种场合？
答：1)  屏蔽（禁止)中断：当处理机正在处理一个中断时，将屏蔽掉所有的中断，直到处理机已处理完本次中断，再去检查是否有中断产生。所有中断按顺序处理，优点是简单，但不能用于实时性要求较高的中断请求。
　　2）嵌套中断：在设置了中断优先级的系统中，当同时有多个不同优先级的中断请求，CPU优先响应优先级最高的中断请求，高优先级的中断请求可以抢占正在运行的低优先级中断的处理机。

##### 10.设备中断处理程序通常需完成哪些工作？
答：1、唤醒被阻塞的驱动进程。

　　2、保护被中断进程的CPU环境。

　　3、转入相应的设备处理程序。

　　4、中断处理。

　　5、恢复被中断进程的现场。
##### 11.简要说明中断处理程序对中断进行处理的几个步骤。
答：1、测定是否有未响应的中断信号

　　2、保护被中断进程的CPU环境

　　3、转入相应的设备处理程序

　　4、中断处理

　　5、恢复CPU的现场并退出中断

##### 12.试说明设备驱动程序具有哪些特点。
答：（1)将接收到的抽象要求转为具体要求；

　　（2）检查用户I/O请求合法性，了解I/O设备状态，传递有关参数，设置设备工作方式；

　　（3）发出I/O命令，启动分配到的I/O设备，完成指定I/O操作；

　　（4）及时响应由控制器或通道发来的中断请求，根据中断类型调用相应中断处理程序处理；

　　（5）对于有通道的计算机，驱动程序还应该根据用户I/O请求自动构成通道程序。

##### 13.设备驱动程序通常需要完成哪些工作？
答：（1) 将接收到的抽象要求转为具体要求；

　　（2) 检查用户I/O请求合法性，了解I/O设备状态，传递有关参数，设置设备工作方式；

　　（3）发出I/O命令启动分配到的I/O设备，完成指定I/O操作；

　　（4）及时响应由控制器或通道发来的中断请求，根据中断类型调用相应中断处理程序处理；

　　（5）对于有通道的计算机，驱动程序还应该根据用户I/O请求自动构成通道程序。
##### 14.简要说明设备驱动程序的处理过程可分为哪几步。
答：1)  将抽象要求转换为具体要求；

　　2）对服务请求进行校验；

　　3）检查设备的状态；

　　4）传送必要的参数。
##### 15.试说明I/O控制发展的主要推动因素是什么？
答：促使I/0控制不断发展的几个主要因素如下：
　　a.尽量减少CPU对I/0控制的干预，把CPU从繁杂的I/0控制中解脱出来，以便更多地去完成数据处理任务。
　　b.缓和CPU的高速性和设备的低速性之间速度不匹配的矛盾，以提高CPU的利用率和系统的吞吐量。
　　c.提高CPU和I/0设备操作的并行程度，使CPU和I/0设备都处于忙碌状态，从而提高整个系统的资源利用率和系统吞吐量。

##### 16.有哪几种I/0控制方式？各适用于何种场合？
答：I/O控制方式：程序I/O方式、中断驱动I/O控制方式、DMAI/O控制方式、I/O通道控制方式。程序I/O方式适用于早期的计算机系统中，并且是无中断的计算机系统；中断驱动I/0控制方式是普遍用于现代的计算机系统中；

DMAI/0控制方式适用于I/O设备为块设备时在和主机进行数据交换的一种I/O控制方式；当I/O设备和主机进行数据交换是一组数据块时通常采用I/O通道控制方式，但此时要求系统必须配置相应的通道及通道控制器。

##### 17.试说明DMA的工作流程。P197

　　　　　　![img](https://img2018.cnblogs.com/i-beta/1641874/201911/1641874-20191115223845563-719466907.png)

##### 18.为什么要引入与设备的无关性?如何实现设备的独立性？
答：引入设备独立性，可使应用程序独立于具体的物理设备，是设备分配具有灵活性。另外容易实现I/O重定向。为了实现设备独立性，必须在设备驱动程序之上设置一层设备独立性软件，用来执行所有I/O设备的公用操作，并向用户层软件提供统一接口。

关键是系统中必须设置一张逻辑设备表LUT用来进行逻辑设备到物理设备的映射，其中每个表目中包含了逻辑设备名、物理设备名和设备驱动程序入口地址三项；

当应用程序用逻辑设备名请求分配I/O设备时，系统必须为它分配相应的物理设备，并在LUT中建立一个表目，以后进程利用该逻辑设备名请求I/0操作时，便可从LUT中得到物理设备名和驱动程序入口地址。
##### 19.与设备的无关的软件中，包括了哪些公有操作的软件?
答：1、设备驱动程序的统一接口

　　2、缓冲管理

　　3、差错控制

　　4、对独立设备的分配与回收

　　5、独立于设备的逻辑数据块

##### 20.在考虑到设备的独立性时，应如何分配独占设备?
（1）进程以逻辑设备名提出I/0请求。
（2）根据逻辑设备表相应表项获得I/0请求的逻辑设备对应类型的物理设备在系统设备表中的指针。
（3）从指针所指位置起顺序检索系统设备表，直到找到一个属于对应I/0请求所用类型、空闲可用且基于设备分配安全性算法验证为安全分配的设备的设备控制表，将对应设备分配给请求进程；

　　如果未找到安全可用的空闲设备，则把请求进程的进程控制块挂到相应类型设备的等待队列上等待唤醒和分配。
（4）系统把设备分配给I/0请求进程后，再到该设备的设备控制表中找出与其相连接的控制器的控制器控制表，根据其状态字段判断该控制器是否忙碌，若忙则把请求进程的进程控制块挂到该控制器的等待队列上；否则将该控制器分配给进程。
（5）系统把控制器分配给I/0请求进程后，再到该控制器的控制器控制表中找出与其相连接的通道的通道控制表，根据其状态字段判断该通道是否忙碌，若忙则把请求进程的进程控制块挂到该通道的等待队列上：否则将该通道分配给进程。
（6）只有在设备、控制器和通道三者都分配成功时，这次的设备分配才算成功，然后便可启动设备进行数据传送。
##### 21.何谓设备虚拟？实现设备虚拟式所依赖的关键技术是什么？
答：通过虚拟技术可将一台独占设备变换成若干台逻辑设备，供若干个用户（进程）同时使用，通常把这种经过虚拟技术处理后的设备称为虚拟设备。其实现所依赖的关键技术是SPOOLING技术。
#####22.在实现后台打印时，SPOOLing 系统应为请求I/O的进程提供哪些服务？
答：1、由输出进程在输出井中为之申请一空闲盘块区，并将要打印的数据送入其中；

　　2、输出进程再为用户进程申请一张空白的用户打印表，并将用户的打印要求填入其中，再将该表挂到请求打印队列上。

　　3、一旦打印机空闲，输出进程便从请求打印队列的队首取出一张请求打印表，根据表中的要求将要打印的数据从输出井传送到内存缓冲区，再由打印机进行打印。

##### 23.假脱机系统向用户提供共享打印机的基本思想是什么？
答：对每个用户而言，系统并非即时执行其程序输出数据的真实打印操作，而只是即时将数据输出到缓冲区，这时的数据并未真正被打印，只是让用户感觉系统已为他打印；

　　真正的打印操作，是在打印机空闲且该打印任务在等待队列中已排到队首时进行的；以上过程是对用户屏蔽的，用户是不可见的。
##### 24.引入缓冲的主要原因是什么？
答：缓和CPU与I/0设备之间速度不匹配的矛盾；减少对CPU的中断频率：放宽对中断响应时间的限制：解决数据力度不匹配的问题；提高CPU和I/0设备之间的并行性。
##### 25.在单缓冲情况下，为什么系统对一块数据的处理时间为max（C，T)+l?
答：在块设备输入时，假定从磁盘把一块数据输入到缓冲区的时间为T；操作系统将缓冲区数据传送给用户区的时间为M；而CPU对这一块数据进行计算得时间为C。
　　在单缓冲情况下，由于设备的输入操作和CPU的处理操作可以并行，所以系统对每一整块数据的处理时间为max（C，T）+M。
##### 26.为什么在双缓冲情况下，系统对一块数据的处理时间为max（C，T）?
答：该方式又称缓冲对换方式，在设备输入时，先将数据送入第一缓冲区，装满后便转向第二缓冲区。此时操作系统可以从第一缓冲区移出数据，并送入用户进程。
　　接着由CPU对数据进行计算。在双缓冲区中，不仅设备的输入操作和CPU的处理操作可以并行，设备的输入操作和数据的传送操作也可以并行，因此耗时大约为max（C+M，T)。考虑到M是内存中数据块的“搬家”耗时，非常短暂可以省略，因此近似地认为是：max（C，T）。

##### 27.试绘图说明把多缓冲用于输出时的情况。

![img](https://img2018.cnblogs.com/i-beta/1641874/201911/1641874-20191115224105999-1478701046.png)

##### 28.试说明收容输入工作缓冲区和提取输出工作缓冲区的工作情况。
答：①收容输入工作缓冲区的工作情况为：在输入进程需要输入数据时，调用GetBuf（EmptyQueue)过程，从EmptyQueue队列的队首摘下一个空缓冲区，作为收容输入工作缓冲区Hin。

　　然后把数据输入其中，装满后再调用PutBuf（InputQueue,Hin)过程，将该缓冲区挂在输入队列InputQueue的队尾。
　　②提取输出工作缓冲区的工作情况为：当要输出数据时，调用GetBuf（OutputQueue)过程，从输出队列的队首取得一装满输出数据的缓冲区作为提取输出工作缓冲区Sout。在数据提取完后，再调用PutBuf(EmptyQueue,Sout)过程，将该缓冲区挂到空缓冲队列EmptyQueue的队尾。

##### 29.何谓安全分配方式和不安全分配方式？
答：①安全分配方式是指每当进程发出I/O请求后，便进入阻塞状态，直到其I/O操作完成时才被唤醒。

　　在采用这种分配策略时，一旦进程已获得某种设备资源后便阻塞，使它不可能再请求任何资源，而在它运行时又不保持任何资源。这种分配方式已经摒弃了造成死锁的“请求和保持”条件，分配是安全的。缺点是进程进展缓慢，CPU与I/O设备串行工作。
　　②不安全分配方式是指进程发出I/O请求后仍继续执行，需要时又可发出第二个I/O请求、第三个I/O请求。仅当进程请求的设备已被另一个进程占有时，进程才进入阻塞状态。

　　优点是一个进程可同时操作多个设备，进程推进迅速。缺点是分配不安全，可能具有“请求和保持”条件，可能造成死锁。因此，在设备分配程序中需增加一个功能，用于对本次的设备分配是否会发生死锁进行安全性计算，仅当计算结果表明分配安全的情况下才进行分配。
##### 30.磁盘访问时间由哪几部分组成？每部分时间应如何计算？
答：磁盘访问时间由寻道时间Ts、旋转延迟时间Tr、传输时间Tt三部分组成。
　　（1）Ts是启动磁臂时间s与磁头移动n条磁道的时间和，即Ts=m×n+s。
　　（2）Tr是指定扇区移动到磁头下面所经历的时间。硬盘15000r/min时Tr为2ms；软盘300或600r/min时Tr为50~100ms。

　　（3）Tt是指数据从磁盘读出或向磁盘写入经历的时间。Tt的大小与每次读/写的字节数b和旋转速度有关：Tt=b/rN。
##### 31.目前常用的磁盘调度算法有哪几种？每种算法优先考虑的问题是什么？
答：目前常用的磁盘调度算法有先来先服务、最短寻道时间优先及扫描等算法。
　　（1）先来先服务算法优先考虑进程请求访问磁盘的先后次序；

　　（2）最短寻道时间优先算法优先考虑要求访问的磁道与当前磁头所在磁道距离是否最近：
　　（3）扫描算法考虑欲访问的磁道与当前磁道间的距离，更优先考虑磁头当前的移动方向。

 
