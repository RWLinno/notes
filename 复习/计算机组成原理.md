# 第一章 计算机组成原理概论

### 冯·诺依曼思想

- 用二进制代码表示程序和数据
- 计算机采用存储程序的工作方式
- 计算机硬件由存储器、运算器、控制器、输入设备和输出设备组成。

##### 存储程序工作方式

1.事先编制程序

2.实现存储程序

3.自动、连续地执行程序

传统冯诺依曼机串行执行指令，改进：增加并行处理功能。



### 硬件组成

##### CPU

由运算器、控制器组成。

运算器用于加工信息，由移位器、ALU、选择器和通用寄存器组组成。

控制器产生控制命令（微命令），控制全机操作。由微命令发生器、指令信息、状态信息和时序信号组成。

微命令产生方式：组合逻辑控制方式和微程序控制方式。

##### 存储器

用于存储信息，由地址寄存器、译码器、存储体、读/写线路、控制线路和数据寄存器组成。

存储体：存放信息的实体

寻址系统：对地址码译码，选择存储单元。

读/写线路和数据寄存器：完成读/写操作，暂存读/写数据。

控制线路：产生读/写时序，控制读/写操作。

##### 输入/输出设备

用于转换信息。



### 硬件系统结构

##### 以总线为基础的系统结构

总线：能为多个部件分时共享的一组信息传送线路。

（1）以CPU为中心的双总线结构

（2）单总线结构

（3）以M为中心的双总线结构

（4）多级总线结构

##### 采用通道或IOP的大型系统结构

（1）带通道的系统

（2）带IOP的系统



### 计算机系统的性能指标

##### 基本字长

指操作数的基本位数，影响计算的精度、指令功能。

##### 存储容量

（1）主存容量：指存储单元个数×位数，表示为字数×字长。

（2）外存容量：常表示为字节数，与地址码位数无关。

##### 运算速度

（1）定点/浮点四则运算时间

（2）每秒平均执行的指令条数（MIPS,MIPOS）

（3）CPU时钟频率

（4）CPI：表示每条指令的周期数。

##### 数据传输率

$ 总线带宽 = \frac{总线位数×总线时钟频率}{8}（B/S）$

##### 处理功能

（1）指令系统功能（寻址方式、指令类型）

（2）系统软件配置



### 计算机软件

##### 软件 = 程序 + 数据 + 文档

（1）操作系统：管理和控制计算机系统的所有资源

（2）实用程序

（3）语言处理程序



# 第二章 运算方法和运算器

### 数据与文字的表示方法

##### 定点表示法

##### 浮点表示法

##### 尾数规格化

规格化数，就说非0的尾数，其绝对值应大于或等于0.5

-1/2原码1.1，补码是1.1，-3/4原码是1.11，补码是1.01，-1/4原码是1.01，补码是1.11

-1/2和-3/4满足规格化定义，绝对值大于等于1/2，小于1

### 数的机器码表示

##### 原码表示法

##### 补码表示法

##### 反码表示法

##### 移码表示法

加上$[X]_{移}=2^n+X$，移码符号位为1时表示正数。

### 汉字的表示方法

汉字输入码

汉字机内码

汉字字型码

### 校验码

##### 奇偶校验码

##### 海明检错与纠错码

n个数据位、k个校验码，满足关系：$2^k \ge n+k+1$，可纠错

##### 循环冗余码

用于串行数据传送中，可纠错。

### 定点加减法运算

##### 补码加减法

##### 逻辑实现

##### 溢出判断

溢出原因/单双符号位判断方法

##### 基本的加法/减法器



### 定点乘法运算

##### 原码并行乘法

人工算法与机器算法的同异性

不带符号的阵列乘法器

带符号的整列乘法器

##### 补码并行乘法

补码与真值的转换公式

一般化的全加器形式

直接补码阵列乘法器

##### 并行阵列乘法器的基本原理

##### 按位扫描技术

##### 一般化的全加器形式

##### 直接补码陈列乘法器



### 定点除法运算

原码除法是指：操作数取绝对值相除，符号位单独处理。

##### 原码恢复余数法

##### 原码不恢复余数法（加减交替法）



### 定点运算器的组成

运算器是数据d加工处理部件，是CPU的重要组成部分。运算器最基本的结构中必须有算数/逻辑运算单元、数据缓冲寄存器、通用寄存器、多路转换器和数据总线等逻辑构件。

##### 逻辑运算

逻辑数指不带符号的二进制数，利用逻辑运算可以进行两个数的比较，或者从某个数中选取某几位等操作。计算机中的逻辑运算，主要是指逻辑非、逻辑加、逻辑乘、逻辑异或四种基本运算。

##### 多功能算术逻辑运算单元

控制端M决定ALU进行算术运算还是逻辑运算。

##### 内部总线

内部总线是指CPU内各部件的连线，外部总线是指系统总线，即CPU与存储器、IO系统之间的连线。单线总线就是信息只能向一个方向传送，双向总线就是信息可以分两个方向传送，既可以发送数据，也可以接收数据。

##### 定点运算器的基本结构

运算器包括ALU、阵列乘除器、寄存器、多路开关、三态缓冲器、数据总线等逻辑部件。

计算机的运算器大体有三种结构形式：①单总线、②双总线、③三总线

### 浮点数四则运算

##### 浮点数加减运算步骤

- 检测能否化简操作。（判操作数是否为0->尾数为0，阶码下溢）
- 对阶：使两数阶码相等（小阶向大阶对齐->小阶阶码增大，尾数右移）
- 尾数加减
- 结果规格化（出现00.0xx或11.1xx时，需要左移规格化，出现01.0xx或10.1xx时，需要右移规格化）
- 舍入处理
- 浮点数的溢出判断

##### 浮点乘法运算步骤

- 检查操作数是否为0
- 阶码相加（若阶码用移码表示，相加后要修正）
- 尾数相乘。（相乘前不需要对阶）
- 结果规格化。（一般左规）

##### 浮点除法运算

- 检测操作数是否为0
- $|AM|<|BM|?$,若不满足，则减小$|AM|$（同时调整AE）
- 阶码相减（若阶码用移码表示，相减后要修正）
- 尾数相除
- 结果**不再**规格化

##### 浮点运算器的流水线原理

各个子任务能在流水线的各个阶段**并发**地执行。

设过程段$S_i$所需·的时间为$\tau_i$，缓冲寄存器的延时为$\tau_l$,**线性流水线的时钟周期**定义为

$\tau = max{\tau_i}+\tau_l=\tau_m+tau_l$

流水线处理的**频率**为$f = \frac{1}{\tau}$

一个具有k级过程的流水线处理n个任务理论上需要的时钟周期数为$T_k = k+(n-1)$

其中k个时钟周期用于处理第一个任务，k个周期后，流水线被装满，剩余的n-1个任务只需要n-1个周期就能完成。若串行进行，则为$T_l=n*k$

我们将比值定义为k级线性流水线的加速比$C_k=\frac{T_l}{T_k}=\frac{n*k}{k+(n-1)}$,当n>>k时，可以说几乎可以提高k倍的速度。

##### 运算器都会设置状态寄存器的目的是为实现程序转移提供判断条件。



# 第三章 存储系统

### 存储器的分类

##### （1）按在系统中的作用分类：

- 主存：存放CPU当前使用的程序和数据（速度快、数量有限）
- 辅存（外存）：存放大量的后备程序和数据（速度较慢、容量大）
- 高速缓存：存放CPU在当前一小段时间内多次使用的程序和数据（速度很快、容量小）

##### （2）按存储介质分类

- 半导体存储器：①利用双稳态触发器存储信息；②速度快，非破坏性读出；③信息易失；④做主存、高速缓存。
- 磁表面存储器：①利用磁层上不同方向的磁化区域表示信息；②容量大，非破坏性读出，长期保存信息；③速度慢；④作外存。
- 光盘存储器：①利用光斑的有无表示信息；②容量很大，非破坏性读出，长期保存信息；③速度慢；④作外存。

##### （3）按存储方式分类

- 随机存取存储器

**随机存取**：可按地址访问存储器的任一单元，访问时间与单元地址无关。

**速度指标**：存取周期或读/写周期(ns)

RAM：可读可写

ROM：只读不写（固存/PROM/EPROM/EEPROM/闪存）

作主存、高速缓存。

- 顺序存取存储器(SAM)

访问时读/写部件按顺序查找目标地址，访问时间与数据位置有关。

两步操作：等待操作/读写操作

速度指标：平均等待时间(ms)，数据传输率(字节/秒)

- 直接存取存储器(DAM)

访问时读/写部件先直接指向一个小区域，再在该区域内顺序查找。访问时间与数据位置有关。

三步操作：定位（寻道）操作、等待（旋转）操作、读写操作

速度指标：平均定位时间、平均等待时间、数据传输率。



### 主存储器的技术指标

存储容量：指一个存储器中可以容纳的存储单元总数。

存储时间：存储器访问时间。

存储周期：连续启动两次读操作所需间隔的最小时间。

存储器带宽：单位时间里存储器所存取的信息量。



### 随机读写存储器RAM

##### 存储原理

- 静态存储器SRAM（双极型、静态MOS型）：**依靠双稳态电路内部交叉反馈的机制存储信息。**功耗较大，速度快，作Cache。
- 动态存储器DRAM（动态MOS型）：**依靠电容存储电荷的原理存储信息**。功耗较小，容量大，速度较快，作主存。

##### 静态MOS存储单元与存储芯片

1.六管单元

2.存储芯片

##### 动态MOS存储单元与存储芯片

1.四管单元

2.单管单元

3.存储芯片

##### 半导体存储器逻辑设计（重点！！！）

需解决：芯片的选用、地址分配与片选逻辑、信号线的连接。

1.计算芯片数：扩展位数和单元数，算出需要芯片数

2.地址分配与片选逻辑

3.连接方式：（1）扩展位数；（2）扩展单元数；（3）连接控制线；（4）形成片选逻辑电路

**存储空间分配**：4KB存储器在16位地址空间（64KB）中占据任意连续区间。

##### 存储器的读写及刷新

1.存储器的读写

2.动态存储芯片的刷新

定义：定期向电容补充电荷——刷新

原因：动态存储器依靠电容电荷存储信息。平时无电源供电，时间一长电容电荷会泄放，需定期向电容补充电荷，以保持信息不变。

最大刷新间隔——2ms

刷新方式——按行读。

刷新周期的安排方式：①集中刷新、分散刷新、异步刷新。



### 只读存储器和闪速存储器

##### ROM 分类

只读存储器简称ROM，只能读出，不能写入。

它的最大优点是具有**不易失性**。

| 只读存储器 | 定义                                                         | 优点                       | 缺点           |
| ---------- | ------------------------------------------------------------ | -------------------------- | -------------- |
| 掩模式     | 数据在芯片制造过程中就确定                                   | 可靠性和集成度高，价格便宜 | 不能重写       |
| 一次编程   | 用户可自行改变产品中某些存储元                               | 可以根据用户需要编程       | 只能一次性改写 |
| 多次编程   | 可以用紫外光照射或电擦除原来的数据，然后再重新写入新的数据。 | 可以多次改写ROM中的内容    |                |

##### 什么是闪速存储器

闪速存储器是一种高密度、非易失性的读/写半导体存储器，它突破了传统的存储器体系，改善了现有的存储器特性。

特点：固有的非易失性、廉价的高密度、可直接执行、固态性能。

闪存实在EPROM功能基础上增加了电路的**电擦除**和**重新编程能力**。

##### 并行存储器

##### 加速CPU和主存之间有效传输措施

- 采用更高速的主存或加长存储器字长
- 采用并行操作的双端口存储器
- 采用cache
- 采用交叉存储器

##### 双端口存储器

指同一个存储器具有两组相互独立的读写控制线路，是一种高速工作的存储器。

##### 多模块交叉存储器

存储器的模块化组织：（顺序组织方式、交叉组织方式）

多模块交叉存储器的基本结构

交叉存储器定量分析：

$设模块字长等于数据总线宽度，模块存取一个字的存储周期为T，\\总线传送周期为\tau，存储器的交叉模块数为m。$

这样，连续读取m个字所需要的时间为$t_1=T+(m-1)*\tau$

![image-20220621141633398](C:\Users\12645\AppData\Roaming\Typora\typora-user-images\image-20220621141633398.png)



##### 相联存储器

指其中任一存储项内容作为地址来存储的存储器。

关键字：选用来寻址存储器的子段。



相联存储器由存储体、检索寄存器、屏蔽寄存器、符合寄存器、比较线路、代码寄存器、控制线路等组成。

检索寄存器：用来存放检索字，其位数和相联存储器的存储单元位数相等。

屏蔽寄存器：用来存放屏蔽码，其位数和检索寄存器位数相同。

符合寄存器：用来存放按检索项内容检索存储体中与之符合的单元地址，其位数等于相联存储器的存储单元个数，每一位对应一个存储单元，位的序数即为相联存储器的单元地址。

比较线路：把检索项和从存储体中读出的所有单元内容的相应位进行比较，如果有某个存储单元的检索项符合，就把符合存储器的相应位置”1“，表示该字已被检索。

代码寄存器：用来存放存储体中读出的代码，或者存放向存储体中写入的代码。

存储体：由高速半导体存储器构成，以求快速存取。



在计算机系统中，相联存储器主要用于虚拟存储器中存放分段表、页表和快表。

在高速缓冲存储器中，相联存储器作为存放cache的行地址之用。

这两个应用都需要快速查找。



### 多层存储层次

##### 存储器的层次结构

![image-20220621143404699](C:\Users\12645\AppData\Roaming\Typora\typora-user-images\image-20220621143404699.png)

##### 各级存储器的主要性能特征

![image-20220621143502905](C:\Users\12645\AppData\Roaming\Typora\typora-user-images\image-20220621143502905.png)

CPU与主存储器的速度差距越来越大

目前相差两个数量级，今后速度差距会越来越大。

##### 相互矛盾

- 速度越快，每位的价格越高
- 容量越大，每位的价格越低
- 容量越大，速度越慢

##### 存储层次设计的四个问题

（1）信息块可以放在高层的哪里？

（2）如果信息块在高层，那么如何找到他？

（3）在失效时，应该替换掉哪个信息块。

（4）在写操作时，会发生是什么情况？



### Cache 存储器

小容量快速存储器，位于CPU和内存之间，也可放在CPU内部，作为单独的模块。

##### Cache命中率

$h = \frac{N_c}{N_c+N_m},其中N_c表示cache完成存取的总次数，N_m表示主存完成存取的总次数。$

若$t_c$表示命中时的Cache访问时间，$t_m$表示为命中时的主存访问时间，1-h表示未命中率，则Cache/主存系统的平均访问时间$t_a$为：

$t_a = h*t_c+(1-h)*t_m$

设$r=\frac{t_m}{t_c}$表示主存慢于Cache的倍率，e表示访问效率，则有：

$e=\frac{t_c}{t_a}=\frac{t_c}{h*t_c+(1-h)*t_m}=\frac{1}{h+(1-h)*r}=\frac{1}{r+(1-r)*h}$

##### 地址映射

一般来说，主存容量远大于Cache容量。因此，当要把一个主存块调入Cache时，就有一个如何放置的问题。这就是映象规则要解决的问题。映象规则有以下三种：

1.全相联映象：将主存中的一个块的地址与块的内容一起存于Cache的行中，其中块地址存于Cache行的标记部分中。Cache的数据块大小成为行，主存的数据块大小称为块。行与块是等长的。

2.直接映象：也是一种多对一的映射关系，但一个主存块只能拷贝到cache的特定行位置去，有函数关系：$i=j \mod m（m为cache的总行数）$

3.组相联映象：前两种方式的折衷方案，它将cache分为u组，每组v行，主存块存放到哪个组是固定的，至于存到该组的哪一行是灵活的，即有如下函数关系：$m = u × v，组号 q=j\mod u$

##### 查找算法

通过查找目录表来实现。

![image-20220621153350564](C:\Users\12645\AppData\Roaming\Typora\typora-user-images\image-20220621153350564.png)

##### 主存与cache的地址映射

内存地址格式：  标记   组号   字号



##### 替换策略

cache工作原理要求它尽量保存最新数据，必然要产生替换。

随机法，FIFO，LRU

##### 写策略

写回法、全写法、写一次法



#### 重点！！！

1.半导体存储器逻辑设计（地址分配、片选逻辑、框图）

2.动态刷新（定义、刷新方式）

3.基本概念如：随机存取、顺序存取、直接存取、静态M的存储原理、动态M的存储原理等。



# 第四章 指令系统

**指令**：是指示计算机某种操作的命令。分微指令，机器指令，宏指令。

**指令系统**：一个计算机中所有机器指令的集合。

**系列计算机**：又共同的指令集，相同的基本体系结构。

**CISC和RISC**

##### 一个完善的指令系统应满足：

完备性、有效性、规整性和兼容性。

##### 指令格式

指令基本格式：$操作码\theta | 地址码 D$

##### 指令字长

- 定长指令格式：便于控制
- 变长指令格式：合理利用存储空间

##### 操作码结构

（1）定长操作码：各指令的位置、位数固定相同。

（2）Huffman编码

（3）扩展操作码：各指令的位置、位数不固定，根据需要变化。关键在设置扩展标记。

（4）复合型操作码：操作码分几部分，每部分表示一种操作。

##### 地址结构

指令中提供的地址数：存储单元地址码/寄存器编号

（1）指令提供地址的方式

- 显地址方式：指令中明显指明地址（直接或间接给出）
- 隐地址方式：地址隐含规定，不出现在指令中。

使用隐地址可以减少指令中的地址数，简化地址结构。

##### 八位微型计算机的指令格式

8位微型机字长只有8位，指令结构是一种可变字长形式，包括单字长、双字长、三字长指令等多种。内存按字节编址，所以单字长指令每执行一条指令后，指令地址+1。双字长指令火哦三字长指令每执行一条指令时，指令地址要+2或+3，可见多字长的指令格式不利于提高机器速度。

##### 指令和数据的寻址方式

- 顺序寻址方式：按照指令在内存的存放位置顺序地取出指令，然后执行的过程。

- 条约寻址方式：程序转移执行的顺序。

##### 常见的寻址方式

操作数寻址是指**寻找操作数地址或操作数**的方式。

（1）立即寻址：指令直接给出操作数。

（2）直接寻址：指令直接给出操作数地址。存储器直接寻址/寄存器直接寻址

（3）间接寻址：指令给出操作的间接地址。存储器间址/寄存器间址/堆栈寻址

（4）变址、基址寻址及其变化。

##### 指令类型

- 传送指令
- 输入/输出指令
- 算术逻辑运算指令
- 程序控制指令



# 第五章 中央处理器

### CPU功能和组成（掌握）

**组成**：运算器、控制器、数据通路结构与外部的连接

1.寄存器组：

（1）通用寄存器组：用户可通过编程访问的寄存器，指令中以寄存器号来指示。

（2）暂存器：暂时存放CPU处理过程中的临时信息，避免破坏通用寄存器的内容。

（3）指令寄存器IR：用来存放当前正在执行的指令。控制器根据其内容产生所需要的各种微命令。

（4）程序计数器PC：指示指令在存储器中的存放位置。

（5）程序状态字寄存器PSW：记录现行程序的运行状态和指示程序的工作方式。包括特征状态位和方式状态位两部分。

（6）地址寄存器MAR：用来保存当前CPU所访问的数据cache存储器中单元的地址。

（7）数据缓冲寄存器MDR：存放CPU与主存之间交换的数据。

2.微指令产生部件：根据指令提供的信息产生出各指令所需要的各种1微命令序列。

3.时序系统：产生计算机所需要的各种时间信息，如周期、节拍、工作脉冲等。这些信号的产生依据是一个频率稳定的振荡器，以及计数分频器或倍频器。

4.控制器：由程序计数器PC，指令寄存器IR，指令译码器，时序产生器和操作控制器组成。主要功能有：

- 从内存中取出一条指令，并指出下一条指令的内存中的位置。

- 对指令进行译码或测试，并产生相应的控制信号。

- 输出相应的控制信号，指挥并控制CPU，内存和I/O之间的数据流动的方向。

5.运算器：由算术逻辑单元ALU，累加寄存器AC，数据缓冲寄存器DR和状态条件寄存器PSW组成，它是数据加工处理部件。主要功能有：

- 执行所有的算术运算
- 执行所有的逻辑运算，并进行逻辑测试。

![image-20220621161841439](C:\Users\12645\AppData\Roaming\Typora\typora-user-images\image-20220621161841439.png)

**工作原理**：指令的执行过程

**基本功能**：

指令控制：程序的顺序控制

操作控制：一条指令有若干操作信号实现

时间控制：指令各个操作实施时间的定时

数据加工：算术运算和逻辑运算

### 指令周期（掌握）

##### 冯诺依曼结构的计算机执行程序的顺序：

1.从程序首地址开始。

2.分步执行每一条指令，并形成下条待执行指令的地址。

3.自动地连续执行指令，直到程序的最后一条指令。

##### 指令的执行过程

1. 读取指令
2. 分析指令
3. 按指令规定内容执行指令
4. 检查有无中断请求

**指令周期**：CPU每取出并执行一条指令，都要完成一系列的操作，这一系列操作所需用的时间通常叫做指令周期。

**机器周期**：机器周期也称为CPU周期。通常用内存中读取一个指令字的最短时间来规定CPU周期。

**时钟周期**：一个CPU周期又包含有若干个时钟周期（通常成为节拍脉冲或T周期，它是处理操作的最基本单位）。这些时钟周期的总和规定了一个CPU周期的时间宽度。

##### MOV指令的指令周期

非访内指令需要两个CPU周期。

第一个CPU周期，即取指令阶段，CPU完成三件事：（1）从指存取出指令；（2）对程序计数器PC加1，以便为下一条指令做准备；（3）对指令操作码进行译码或测试，以便确定进行什么操作。

LAD 指令 三个周期：1个取指周期/2个执行周期

### 时序产生器和控制方式（理解）

组成计算机硬件的器件特性决定了时序信号最基本的机制是电位——脉冲制。

操作控制器可分为时序逻辑型、存储逻辑型、时序逻辑与存储逻辑结合型三种。

1.硬布线控制器是采用时序逻辑技术来实现的。

2.微程序控制器是采用存储逻辑来实现的。

硬布线控制器中，时序信号采用主状态周期——节拍电位——节拍脉冲三级体制。

主状态周期（指令周期）：包括若干个节拍周期，可以用一个触发器的状态持续时间来表示

节拍电位（机器周期）：表示一个CPU周期的时间，包含若干个节拍脉冲，表示较大的时间单位。

节拍脉冲（时钟周期）：表示较小的时间单位。

##### 组合逻辑控制器原理

##### 控制器组成

- 微命令发生器：产生全机所需的各种微命令。

- **指令计数器PC**：指示指令在M中的位置。
- **指令寄存器IR**：存放现行指令。
- 状态寄存器PSW：指示程序运行方式，反映程序运行的结果。
- 时序线路：控制操作时间和操作时刻。

##### 控制器工作过程

- 取指令
- 取数
- 执行

##### 时序部件

脉冲源及启停逻辑

时序信号形成部件

控制方式

##### 时序控制方式

（1）同步方式：各项操作受统一时序控制

有明显时序时间划分，时钟周期时间固定，各步操作的衔接、各部件之间的数据传送受严格同步定时控制。

（2）异步控制：各项操作按不同需要安排时间，不受统一时序控制。

无统一时钟周期划分，各操作间的衔接和各部件之间的信息交换采用异步应答方式。

（3）混合方式

①不同指令安排不同时钟周期数

②总线周期中插入延长周期

##### 组合逻辑控制方式

### 微程序控制器（掌握）

##### 微程序控制的基本思想

1.若干微指令编制成一条微指令，控制实现一步操作

2.若干微指令组成一段微程序，解释执行一条机器指令

3.微程序实现存放在控制存储器中，执行机器指令时再取出

##### 组成原理及主要部件

（1）控制存储器CM：存放微程序

（2）微指令寄存器$\mu IR$：存放现行微指令。

（3）微地址形成电路：提供两类微地址。

##### 工作过程

- 取机器指令：$CM-> \mu IR->译码器->主存->IR$

- 转微程序入口：$IR->微地址形成电路->\mu AR->CM->\mu IR$
- 执行首条微指令：$\mu IR-> 译码器->操作部件$
- 取后续微指令：$微地址字段现行微地址运行状态->微地址形成电路—>\mu AR->CM->\mu IR$
- 执行后续微指令
- 返回

##### 微指令格式和编码方法

（1）垂直型微指令：一条微指令定义并执行一种基本操作。

（2）水平型微指令：一条微指令定义并执行几种并行的基本操作。

（3）混合型微指令：再垂直型的基础上增加一些不太复杂的并行操作。

##### 编码方法

（1）直接控制法：微命令按位给出。

（2）分段直接编译法：微命令由字段编码直接给出。

（3）分段间接编译法：微命令由本字段编码和其他字段解释共同给出。

（4）其他编码方法

##### 微程序时序安排

##### 微程序控制方式优缺点和应用

1.优点

- 设计规整，设计效率高
- 易于修改、扩展指令系统功能
- 结构规整、简洁，可靠性高
- 性价比高

2.缺点：

- 速度慢
- 执行效率不高

3.应用范围：

用于速度要求不高、功能较复杂的机器中。

### 微程序设计技术（掌握）



### CPU的新技术（理解）

##### 流水CPU

同时性：指两个以上事件在同一时刻发生

并发性：指两个以上事件在同一时间间隔发生

##### 流水计算机的系统组成

指令部件、指令队列、执行部件。

**超标量**：是并存处理思想在微处理器设计中的应用。

##### 流水线的分类

指令流水线

算术流水线

处理机流水线

##### 主要问题

资源相关：多条指令进入流水线后在同一机器时钟周期内争用同一个功能部件所发生的冲突。

数据相关：在一个程序中，如果必须等前一条指令执行完毕后，才能执行后一条指令，那么这两条指令就是数据相关的。

控制相关：当执行转移指令时，依据转移条件的产生结果，可能为顺序取下条指令，也可能转移到新的目标地址取指令，从而使流水线发生断流。

##### Pentium CPU

CPU内部的主要寄存器宽度为32位，故认为它是一个32位微处理器。

##### RISC三要素

（1）一个有限的简单的指令集

（2）CPU配备大量的通用寄存器

（3）强调对指令流水线的优化

##### MMX技术

##### 动态执行技术



# 第七章 外围设备

**定义**：除了CPU和主存之外的部件都可看作外设。

**功能**：在计算机和其他机器，或与用户之间提供联系。

**基本组成：**存储介质、驱动装置、控制电路。

### 磁盘存储设备

##### 磁记录原理

##### 硬磁盘机的基本组成和分类

##### 硬磁盘驱动器和控制器

##### 磁盘上信息的分布

- 记录面
- 磁道
- 扇区

##### 磁盘存储器的技术指标

- 存储密度：

- - 道密度：沿磁盘半径方向单位长度的磁道数。单位：道/英寸
  - 位密度：磁道单位长度上能记录的二进制代码位数。单位：位/英寸（0磁道的位密度位最低位密度）

  - 面密度：位密度和道密度的乘积。单位：位/平方英寸

- 存储容量：
- - 存储容量=记录面数X每面磁道数X磁道容量。
  - 非格式化容量：磁记录表面可以利用的磁化单元总数。
  - 格式化容量：真正能够使用的容量，一般是非格式化容量的60%~70%
- 平均存储时间
- - 平均存取时间=平均寻道时间+平均等待时间+数据读取时间
  - 平均寻道时间：最大与最小寻道时间的平均值，约为10~20ms
  - 平均等待时间：与磁盘转速有关，是磁盘旋转一周时间的一半。

- 数据传输率
- - 与存储设备和主机接口逻辑有关。
  - 设磁盘旋转速度位每秒n转，磁道容量为N个字节，数据传输率Dr=n×N（字节/秒）
  - 设某磁道位密度为D字节/英寸，磁盘转速为v英寸/秒，则数据传输率Dr=D×v(字节/秒)

### 磁带存储设备

磁带存储设备由磁带机和磁带两部分组成，它通常用作为海量存储设备的数据备份。

磁带速度比磁盘速度慢，原因是磁带上的数据采用**顺序访问**方式，而磁盘则采用**随机访问**方式。

### 光盘和磁光盘存储设备

|      | 速度 | 可换性 | 读写方式 | 价格 | 容量 | 适用场合                     |
| ---- | ---- | ------ | -------- | ---- | ---- | ---------------------------- |
| 硬盘 | 高   | 不可以 | 非接触式 | 较高 | 较大 | 作为主存后援，存放软件和数据 |
| 磁带 | 低   | 可以   | 接触式   | 较低 | 较小 | 海量后备（顺序存取）         |
| 光盘 | 较高 | 可以   | 非接触式 | 大   | 大   | 存软件、图文资料档案等       |

### 显示设备

##### 分类

- 按显示器件分类：阴极射线管(CRT)显示器、液晶显示器(LCD)、等离子显示器等
- 按显示内容分类：字符显示器、图形显示器、图像显示器。

##### 随机扫面和光栅扫描

随机：只需在做图的地方扫描

光栅：电子束从上至下扫描整个屏幕，又分为逐行扫描和隔行扫描两种方式。

##### 像素和分辨率

##### 灰度级

##### 刷新和刷新存储器

刷新存储器带宽=分辨率×颜色深度×刷新频率

##### 达到高刷存带宽

①使用高速的DRAM芯片组成刷存

②刷存采用多体交叉结构

③刷存至显示控制器的内部总线宽度由32位提高到64位，甚至128位

④刷存采用双端口存储器结构，将刷新端口与更新端口分开



# 第八章 输入输出系统

### 外围设备的速度分级与信息交换方式（了解）

##### 按速度分级

①速度极慢或简单的外围设备如：机械开关、发光二极管

②慢速或中速的外围设备如：键盘或显示器

③高速的外围设备如：主存、辅存

##### 外设信息交换方式

①程序查询方式

②程序中断方式

③直接内存访问(DMA)方式

④通道方式



### 程序查询方式（了解）

数据的输入输出完全由程序控制。

##### 设备编址

统一编址方式：将I/O设备与主存系统作为一个整体进行编址。优点：访问I/O端口可使用访存指令，操作类型多样，使用灵活；I/O端口有较大的编址空间。缺点：占有主存空间，使实际主存容量减小；I/O访问的指令字长较长，执行速度慢。

独立编址方式：将I/O系统与主存系统分别编址。特点：I/O端口地址不占用主存空间；使用专用的I/O指令，指令字长短，执行速度块；与主存空间区分容易。

##### 输入输出指令

##### 程序查询方式的接口

##### 程序查询输入/输出方式

### 程序中断方式（掌握）

##### 中断的基本概念

中断是指CPU正常运行程序时，由**系统内/外部非预期事件**或**程序中预先安排好的指令性事件**引起的，CPU暂停当前程序的执行，转去为该事件服务的程序中执行，服务完毕后，再返回原程序继续执行的过程。

注意：

- 中断是一个CPU执行程序的**变换过程**；
- 所有能引起中断的事件均称为**中断源**；
- 处理中断事件的**中断服务程序**是预先设置好的；
- 结束中断返回原程序时，要以**原状态返回**暂停处继续执行。

CPU的中断处理流程：

- 中断请求
- 中断响应
- 中断服务
- 中断返回

中断向量合中断向量表

##### 程序中断方式的基本IO接口

接口内部组成：数据缓冲寄存器；就绪触发器RD、忙状态触发器BS、允许中断触发器EI；中断向量产生逻辑

CPU的相应部件：中断请求触发器IR、中断屏蔽触发器IM

程序中断的数据传送过程

##### 中断处理的策略

- 单级中断：所有的中断源都属于同一个级别，不允许有中断嵌套。

- 多级中断：中断源分为不同的级别，可以发生中断嵌套，高优先权的中断源请求可以打断低优先权的中断服务。

##### 中断控制器

##### PC系列机中断机制



### DMA方式（掌握）

##### 特点

速度快，但硬件复杂度高。

##### DMA数据传送过程

DMA请求：向CPU请求总线使用权。

DMA响应：给DMAC分配总线使用权。

DMA传送：DMAC寻址外设和存储器；DMAC控制外设与主存之间的数据传送，并检查是否传送结束；

DMAC：归还总线使用权。

##### DMA方式与中断控制方式的区别

数据传送的实现：中断——程序传送；DMA——硬件实现

CPU响应请求的时间：中断——一个指令周期结束；DMA——一个总线周期结束

请求的目的：中断——CPU的服务；DMA——总线的使用权

是否保护现场：中断——需要；DMA——不需要

DMA的优先权高于中断的优先权。

##### DMAC的类型

选择性DMA

多路型DMAC

### 通道方式（了解）

##### 通道的功能

执行通道指令、组织外围设备和内存进行数据传输；

按I/O指令要求启动外围设备，向CPU报告中断

##### 通道的类型

选择通道

多路通道

##### 通道结构的发展

通道结构的I/O处理器

外围处理机

### 通用I/O标准接口

并行I/O标准接口SCIS

高速串行I/O标准接口IEEE1394





# 题集

某计算机的Cache共有16块，采用2路组相联映射方式（即每组2块）。每个主存块大小为32字节，按字节编址。主存129号单元所在主存块应装入到的Cache组号是**4**
$$
1.组相联映射方式下，主存块按模Q(Q为Cache组数)映射到Cache对应组中的任一块；\\

Cache共有16块，采用2路组相联映射，故Cache共分16/2=8组，每组2块。每块32B。\\

2.主存分为若干组，每组又分成8块。每块32字节。\\

3.129的二进制表示为10000001→0...010000001（组内块序号为100）如下图，所以组号为4
$$

一般Cache采用**高速的SRAM**制作，比ROM速度快很多。

Cache是一种**高速缓冲**存储器，是为了解决CPU和主存之间**速度不匹配**二采用的一项重要硬件技术。

存储器的技术指标有**存储容量**，**存储时间**，**存储周期**和**存储器带宽**。



采用**隐式I/O指令**，是指用**传送指令**实现I/O操作。

 单地址指令是指**指令隐含提供了所需的其他操作数**。

微程序执行的顺序控制问题，实际上是如何确定下一条微指令的地址问题。通常采用的一种方法是断定方式，其基本思想是**通过微程序顺序控制字段或设计者指定的判断字段控制产生的后继微指令地址。**

RISC大多数指令的执行时间为**一个处理时钟周期**，RISC的内部**通用寄存器数量**相对CISC多，RISC的**指令数、寻址方式和指令格式种类**相对CISC少。

相对于微程序控制器，硬布线控制器的特点是**指令执行速度块，指令功能的修改和扩展难**。

**微程序控制方式的基本思想：**一个微指令包含若干微命令，控制一步操作；一段微程序包括若干个微指令，解释执行一条机器指令；微程序事先存放在控存中。

**机器指令与微指令之间的关系：**

- 一个机器指令对应一个微程序，这个微程序是由若干条微指令序列组成的。因此，一条机器指令的功能是由若干条微指令组成的序列来实现的。简言之，一条机器指令所完成的操作划分成若干条微指令来完成，由微指令进行解释和执行。
- 从指令与微指令，程序与微程序，地址与微地址的一一对应关系来看，前者与内存储器有关，后者与控制存储器有关。
- 每一个CPU周期对应一条微指令。

按存储方式分类，存储器分为**随机**存取存取器、**顺序**存取存储器和**直接**存取存储器。

对于单片机和微型机，I/O数据传送主要有三种不同的控制方式：**程序直接控制、通道控制和DMA控制**。其中，CPU和外设可以并行工作的方式是**DMA控制**，CPU和外设只能串行工作的方式是**程序查询方式**。

微指令格式可分为**水平型**和**垂直型**两种，其中**垂直型**微指令用较长的微程序结构换取较短的微指令结构。

指令的地址码给出**存储器地址**的加法指令，在执行周期一定访存。

DMA访问主存时，让CPU处于等待状态，等DMA的一批数据访问结束后，CPU再恢复工作，这种情况称为**停止CPU访问主存**。



##### CISC与RISC比较

| 比较内容           | CISC                 | RISC                     |
| ------------------ | -------------------- | ------------------------ |
| 指令字长           | 不固定               | 等长                     |
| 可访存指令         | 不加限制             | 只有取数/存数指令        |
| 各种指令的使用频率 | 相差很大             | 相差不大                 |
| 各种指令执行时间   | 相差很大             | 绝大多数在一个周期内完成 |
| 优化编译实现       | 很难                 | 较简单                   |
| 程序源代码长度     | 较短                 | 较长                     |
| 控制器实现方式     | 绝大多数为微程序控制 | 绝大多数为硬布线控制     |
| 软件系统开发时间   | 较短                 | 较长                     |



动态RAM的刷新是以**行**为单位进行的。

和SRAM相比，DRAM在电路结构及性能上的主要不同之处有：

①地址线封装引脚数少

②速度慢，集成度高

③增加了行、列地址锁存器

④需要定期刷新



建立高速缓存存储器的理论依据是**程序的局部性原理**。

交叉存储器实际上是一种**模块式**存储器，它能**并行**执行**多个**独立的读写操作。

cache的功能**全由硬件实现**。

引入多道程序的目的在于**充分利用CPU，减少CPU等待时间**。

虚拟段页式存储管理方案的特性为**空间浪费小、存储共享容易、存储保护容易、能动态连接**。

在cache的存储器系统中，当程序正在执行时，由**硬件**完成地质变化。

微程序控制器主要由**控制存储器，微指令寄存器和地址转移逻辑**三大部分组成。其中控制存储器是**只读型**存储器，它用来存放**实现指令系统的全部微程序**。

微地址是指微指令**在控制存储器的存储位置**。

为了确定下一条微指令的地址，通常采用断定方式（即多路转移方式），其基本思想是**通过微指令顺序控制字段由设计者指定或者由设计者指定的判别控制字段产生后继微指令地址**。

由于CPU内部的操作速度较快，而CPU访问一次主存所花的时间较长，因此机器周期通常用**主存中读取一个指令字的最短时间**来规定。

控制存储器可以用**掩膜ROM、EPROM或闪速存储器**实现。
